<!DOCTYPE html>
<html class="no-js" >
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Parsing custom database &mdash; MARIO 0.3 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/dist/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
            <link rel="index" title="Index" href="../../genindex.html" />
            <link rel="search" title="Search" href="../../search.html" />
            <link rel="top" title="MARIO 0.3 documentation" href="#" />
            <link rel="up" title="Examples" href="../../examples.html" />
            <link rel="next" title="API Reference" href="../../api_refernces.html" />
            <link rel="prev" title="Parsing Exiobase v3.8.2 (Monetary units)" href="../tutorial_parse_exiobase_monetary/tutorial_parse_exiobase_monetary.html" />
    </head>
<body>
    <script type="text/javascript" src="../../_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="/"
                        title="MARIO"
                        class="logo navbar-brand"
                    >
                        <img src="../../_static/mario.png" width="45" height="59" alt="MARIO"
                            class="logo-img"
                        />
                        MARIO Documentation
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="../../search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">MARIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#quickstart">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#read-more">Read more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html">Changing mario settings</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorial_data_template/tutorial_data_template.html">Creating an Empty Database, from tabular information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_add_extensions/tutorial_add_extensions.html">Adding satellite accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_shock_analysis/tutorial_shock_analysis.html">Shcok Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_transformation_isard_to_chenery/tutorial_transformation_isard_to_chenery.html">Transforming a SUT table from Isard to Chenery-Moses model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_transformation_sut_to_iot/tutorial_transformation_sut_to_iot.html">Transforming a SUT into an IOT table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_figaro_parser/tutorial_figaro_parser.html">Figaro Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_eora/tutorial_parse_eora.html">Parsing EORA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_exiobase_hybrid/tutorial_parse_exiobase_hybrid.html">Parsing Exiobase v3.3.18 (supply-use hybrid-units)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_exiobase_monetary/tutorial_parse_exiobase_monetary.html">Parsing Exiobase v3.8.2 (Monetary units)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parsing custom database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_refernces.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.is_balanced.html">mario.CoreModel.is_balanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.is_multi_region.html">mario.CoreModel.is_multi_region</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.is_hybrid.html">mario.CoreModel.is_hybrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.sets.html">mario.CoreModel.sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.scenarios.html">mario.CoreModel.scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.table_type.html">mario.CoreModel.table_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.get_index.html">mario.CoreModel.get_index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.is_chenerymoses.html">mario.CoreModel.is_chenerymoses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.is_isard.html">mario.CoreModel.is_isard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.aggregate.html">mario.Database.aggregate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.add_sectors.html">mario.Database.add_sectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_single_region.html">mario.Database.to_single_region</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_iot.html">mario.Database.to_iot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.add_extensions.html">mario.Database.add_extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.update_scenarios.html">mario.Database.update_scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.reset_to_flows.html">mario.Database.reset_to_flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.reset_to_coefficients.html">mario.Database.reset_to_coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.clone_scenario.html">mario.Database.clone_scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.copy.html">mario.Database.copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.backup.html">mario.Database.backup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_chenery_moses.html">mario.Database.to_chenery_moses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.shock_calc.html">mario.Database.shock_calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.set_palette.html">mario.set_palette</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.plot_gdp.html">mario.Database.plot_gdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.plot_bubble.html">mario.Database.plot_bubble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.plot_linkages.html">mario.Database.plot_linkages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.plot_matrix.html">mario.Database.plot_matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.get_aggregation_excel.html">mario.Database.get_aggregation_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.get_extensions_excel.html">mario.Database.get_extensions_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.get_add_sectors_excel.html">mario.Database.get_add_sectors_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.get_shock_excel.html">mario.Database.get_shock_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_excel.html">mario.Database.to_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_txt.html">mario.Database.to_txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.to_pymrio.html">mario.Database.to_pymrio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_exiobase_3.html">mario.parse_exiobase_3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_exiobase_sut.html">mario.parse_exiobase_sut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_eurostat_sut.html">mario.parse_eurostat_sut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_eora.html">mario.parse_eora</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_from_pymrio.html">mario.parse_from_pymrio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.hybrid_sut_exiobase.html">mario.hybrid_sut_exiobase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_exiobase.html">mario.parse_exiobase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_from_excel.html">mario.parse_from_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.parse_from_txt.html">mario.parse_from_txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.calc_all.html">mario.CoreModel.calc_all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.GDP.html">mario.CoreModel.GDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.Database.calc_linkages.html">mario.Database.calc_linkages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_X.html">mario.calc_X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_X_from_w.html">mario.calc_X_from_w</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_X_from_z.html">mario.calc_X_from_z</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_Z.html">mario.calc_z</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_E.html">mario.calc_e</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_V.html">mario.calc_v</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_M.html">mario.calc_m</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_F.html">mario.calc_f</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_w.html">mario.calc_w</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_g.html">mario.calc_g</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_b.html">mario.calc_b</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_p.html">mario.calc_p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.calc_y.html">mario.calc_y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.save_meta.html">mario.CoreModel.save_meta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.meta_history.html">mario.CoreModel.meta_history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.add_note.html">mario.CoreModel.add_note</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.load_test.html">mario.load_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.directory.html">mario.CoreModel.directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.CoreModel.search.html">mario.CoreModel.search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.slicer.html">mario.slicer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.set_log_verbosity.html">mario.set_log_verbosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.upload_settings.html">mario.upload_settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.download_settings.html">mario.download_settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_document/mario.reset_settings.html">mario.reset_settings</a></li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../../index.html">Docs</a></li>
            <li class="breadcrumb-item"><a href="../../examples.html">Examples</a></li>
        <li class="breadcrumb-item active" aria-current="page">Parsing custom database</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/wagtail/sphinx_wagtail_theme/blob/main/docs/examples/tutorial_parse_custom_database/tutorial_parse_custom_database.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../../_sources/examples/tutorial_parse_custom_database/tutorial_parse_custom_database.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <div class="section" id="parsing-custom-database">
<h1>Parsing custom database<a class="headerlink" href="#parsing-custom-database" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to build a custom database in Excel and how to
parse it using MARIO.</p>
<div class="section" id="parsing-from-excel">
<h2>Parsing from Excel<a class="headerlink" href="#parsing-from-excel" title="Permalink to this headline">¶</a></h2>
<p>Start by opening Excel or any equivalent software. Any custom
MARIO-readable IOT must follow these rules: - It must be in .xlsx format
- It must have two sheets. The first must contain the table, the second
must be named “units” and contains the info on units of measure</p>
<p>For instance, the following example is for a SUT of 2 regions, 2
commodities and 2 activities.</p>
<div class="section" id="table-sheet">
<h3>Table sheet<a class="headerlink" href="#table-sheet" title="Permalink to this headline">¶</a></h3>
<div class="figure align-default" id="id1">
<img alt="Alt text" src="../../_images/SUT_example.jpg" />
<p class="caption"><span class="caption-text">Alt text</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The structure is the same for both IOTs and SUTs with the difference
SUTs must differenciate between activities and commodities, while IOTs
just needs sectors. You will notice: - There must be 3 level of indices
on both rows and columns - The first level is always the name of the
region, apart from those table sets not defined on regions, such as
“Factor of production” and “Satellite account”. For these two sets, just
provide “-”. - The second level is always the name of the set
(i.e. “Activity”, “Commodity”, “Consumption category”, “Factor of
production”, “Satellite account”). In case of an IOT, provide “Sector”
instead of “Activity” and “Commodity” - The third level is a label,
referring to the name of the item - There must not be blank cells within
the matrices There are no particular rules for the order of the labels
and sets, MARIO will always sort all the indices in alphabetical order
before doing any calculation.</p>
</div>
<div class="section" id="units-sheet">
<h3>Units sheet<a class="headerlink" href="#units-sheet" title="Permalink to this headline">¶</a></h3>
<p>Regardin unit of measures, this sheet must be named “units” and the
header of the column of units (column C of the sheet) must be labelled
“unit” as in the following example</p>
<div class="figure align-default" id="id2">
<img alt="Alt text" src="../../_images/units_example.jpg" />
<p class="caption"><span class="caption-text">Alt text</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Again the rules are on the indices, that must be provided for all the
labels, avoiding repeating the same label for multiple regions: regions
indeed are not required in this sheet. MARIO can handle hybrid-units
databases.</p>
</div>
</div>
<div class="section" id="parsing-a-customized-database">
<h2>Parsing a customized database<a class="headerlink" href="#parsing-a-customized-database" title="Permalink to this headline">¶</a></h2>
<p>Once the customized database is prepared in Excel, just provide the
path, type of table (SUT or IOT) and the mode (flows or coefficients)
and MARIO will be able to parse it using the “parse_from_excel” function</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mario</span>  <span class="c1"># Import MARIO</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;custom_SUT.xlsx&#39;</span>  <span class="c1"># Define the desired path to the folder where Exiobase should be downloaded</span>

<span class="n">database</span> <span class="o">=</span> <span class="n">mario</span><span class="o">.</span><span class="n">parse_from_excel</span><span class="p">(</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">,</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;SUT&#39;</span><span class="p">,</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;flows&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">X</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Item</th>
      <th>production</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Level</th>
      <th>Item</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">R1</th>
      <th rowspan="2" valign="top">Activity</th>
      <th>Production of Goods</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Production of Services</th>
      <td>0.9</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">R2</th>
      <th rowspan="2" valign="top">Activity</th>
      <th>Production of Goods</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Production of Services</th>
      <td>1.2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">R3</th>
      <th rowspan="2" valign="top">Activity</th>
      <th>Production of Goods</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Production of Services</th>
      <td>0.9</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">R1</th>
      <th rowspan="2" valign="top">Commodity</th>
      <th>Goods</th>
      <td>45.0</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>31.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">R2</th>
      <th rowspan="2" valign="top">Commodity</th>
      <th>Goods</th>
      <td>66.0</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>44.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">R3</th>
      <th rowspan="2" valign="top">Commodity</th>
      <th>Goods</th>
      <td>61.0</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>44.0</td>
    </tr>
  </tbody>
</table>
</div><p>The same structure is replicable for IOT database. If you want to see
how the table should look like, you can load the test models and save
them to excel to have a closer look to the structure:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mario</span><span class="o">.</span><span class="n">load_test</span><span class="p">(</span><span class="s2">&quot;IOT&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;test_iot.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="parsing-from-pd-dataframes">
<h2>Parsing from pd.DataFrames<a class="headerlink" href="#parsing-from-pd-dataframes" title="Permalink to this headline">¶</a></h2>
<p>You can also build a mario.Database, using pd.DataFrames:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mario</span> <span class="kn">import</span> <span class="n">Database</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating indeces according to mario format</span>
<span class="n">regions</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;reg.1&#39;</span><span class="p">]</span>
<span class="n">Z_levels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span>
<span class="n">sectors</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sec.1&#39;</span><span class="p">,</span><span class="s1">&#39;sec.2&#39;</span><span class="p">]</span>

<span class="n">factors</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Labor&#39;</span><span class="p">]</span>
<span class="n">satellite</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>


<span class="n">Y_level</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Consumption category&#39;</span><span class="p">]</span>
<span class="n">demands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Households&#39;</span><span class="p">]</span>

<span class="n">Z_index</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">regions</span><span class="p">,</span><span class="n">Z_levels</span><span class="p">,</span><span class="n">sectors</span><span class="p">])</span>
<span class="n">Y_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">regions</span><span class="p">,</span><span class="n">Y_level</span><span class="p">,</span><span class="n">demands</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># creating matrices</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">70</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="p">]]),</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">Z_index</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span> <span class="n">Z_index</span>
<span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">200</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">80</span><span class="p">]]),</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">Z_index</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span> <span class="n">Y_columns</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">]]),</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">satellite</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span> <span class="n">Z_index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">220</span><span class="p">,</span><span class="mi">60</span><span class="p">]]),</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">factors</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span> <span class="n">Z_index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">EY</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">]),</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">satellite</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span> <span class="n">Y_columns</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">reg.1</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Sector</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>sec.1</th>
      <th>sec.2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">reg.1</th>
      <th rowspan="2" valign="top">Sector</th>
      <th>sec.1</th>
      <td>10</td>
      <td>70</td>
    </tr>
    <tr>
      <th>sec.2</th>
      <td>50</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>reg.1</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>Consumption category</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>Households</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">reg.1</th>
      <th rowspan="2" valign="top">Sector</th>
      <th>sec.1</th>
      <td>200</td>
    </tr>
    <tr>
      <th>sec.2</th>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div><p>You also need to identify the units in a separate python dict as follow:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># units as a dict of pd.DataFrames</span>
<span class="n">units</span><span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Sector&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="s1">&#39;EUR&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">sectors</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;Satellite account&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="s1">&#39;Ton&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">satellite</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;Factor of production&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="s1">&#39;EUR&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">factors</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>
    <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">units</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;Sector&#39;</span><span class="p">:</span>       <span class="n">unit</span>
 <span class="n">sec</span><span class="mf">.1</span>  <span class="n">EUR</span>
 <span class="n">sec</span><span class="mf">.2</span>  <span class="n">EUR</span><span class="p">,</span>
 <span class="s1">&#39;Satellite account&#39;</span><span class="p">:</span>     <span class="n">unit</span>
 <span class="n">CO2</span>  <span class="n">Ton</span><span class="p">,</span>
 <span class="s1">&#39;Factor of production&#39;</span><span class="p">:</span>       <span class="n">unit</span>
 <span class="n">Labor</span>  <span class="n">EUR</span><span class="p">}</span>
</pre></div>
</div>
<p>Now you can create a mario.Database object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a mario database</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span>
    <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
    <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
    <span class="n">E</span><span class="o">=</span><span class="n">E</span><span class="p">,</span>
    <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span>
    <span class="n">EY</span><span class="o">=</span><span class="n">EY</span><span class="p">,</span>
    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;IOT&#39;</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;iot test&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">z</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Region</th>
      <th colspan="2" halign="left">reg.1</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Level</th>
      <th colspan="2" halign="left">Sector</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Item</th>
      <th>sec.1</th>
      <th>sec.2</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Level</th>
      <th>Item</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">reg.1</th>
      <th rowspan="2" valign="top">Sector</th>
      <th>sec.1</th>
      <td>0.035714</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>sec.2</th>
      <td>0.178571</td>
      <td>0.071429</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Database</span><span class="p">:</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">p</span> <span class="n">following</span> <span class="n">matrices</span> <span class="n">are</span> <span class="n">need</span><span class="o">.</span>
<span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Trying</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">dependencies</span><span class="o">.</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>price index</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Level</th>
      <th>Item</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">reg.1</th>
      <th rowspan="2" valign="top">Sector</th>
      <th>sec.1</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>sec.2</th>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div><p><code class="xref download docutils literal notranslate"><span class="pre">Link</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">jupyter</span> <span class="pre">notebook</span> <span class="pre">file</span></code>.</p>
</div>
</div>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="../tutorial_parse_exiobase_monetary/tutorial_parse_exiobase_monetary.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Parsing Exiobase v3.8.2 (Monetary units)
    </a>
    <a class="float-right" href="../../api_refernces.html" title="Next">
        API Reference <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Parsing custom database</a><ul>
<li><a class="reference internal" href="#parsing-from-excel">Parsing from Excel</a><ul>
<li><a class="reference internal" href="#table-sheet">Table sheet</a></li>
<li><a class="reference internal" href="#units-sheet">Units sheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parsing-a-customized-database">Parsing a customized database</a></li>
<li><a class="reference internal" href="#parsing-from-pd-dataframes">Parsing from pd.DataFrames</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/features/">Features</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/about-wagtail/"> About Wagtail</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/services/"> Services</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/blog/"> Blog</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/packages/"> Packages</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/developers/"> Developers</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                <p style="display: none">
                    <a class="text-light" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Wagtail Sphinx Theme 6.3.0
                    </a>
                </p>
            </div>
            <div class="text-center">
                    &copy; Copyright 2021, MARIO Authors: Mohammad Amin Tahavori, Lorenzo Rinaldi, Nicolo Golinucci
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../../_static/searchtools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("../../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>