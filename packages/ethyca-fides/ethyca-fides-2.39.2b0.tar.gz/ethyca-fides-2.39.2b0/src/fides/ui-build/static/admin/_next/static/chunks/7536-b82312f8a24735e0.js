(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7536],{44204:function(e,t,r){"use strict";r.d(t,{q:function(){return u}});var n=r(90849),s=r(90089),i=r(28841),o=r(24246),a=["label","isDisabled"],c=["data","border"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=function(e){var t=e.label,r=e.isDisabled,n=(0,s.Z)(e,a);return(0,o.jsx)(i.OK9,{"data-testid":"tab-".concat(t),_selected:{fontWeight:"600",color:"complimentary.500",borderColor:"complimentary.500"},fontSize:n.fontSize,fontWeight:"500",color:"gray.500",isDisabled:r||!1,children:t})};t.Z=function(e){var t=e.data,r=e.border,n=void 0===r?"partial":r,a=(0,s.Z)(e,c);return(0,o.jsxs)(i.mQc,d(d({colorScheme:"complimentary"},a),{},{children:[(0,o.jsx)(i.tdY,{width:"partial"===n?"max-content":void 0,children:t.map((function(e){return(0,o.jsx)(u,{label:e.label,isDisabled:e.isDisabled,fontSize:a.fontSize},e.label)}))}),(0,o.jsx)(i.nPR,{children:t.map((function(e){return(0,o.jsx)(i.x45,{px:0,"data-testid":"tab-panel-".concat(e.label),children:e.content},e.label)}))})]}))}},9408:function(e,t,r){"use strict";r.d(t,{HK:function(){return i},VY:function(){return n.V},O3:function(){return a}});var n=r(36653),s=r(78624),i=function(){var e=(0,n.V)().errorAlert;return{handleError:function(t){var r="An unexpected error occurred. Please try again.";(0,s.Ot)(t)?r=t.data.detail:(0,s.tB)(t)&&(r=t.data.detail[0].msg),e(r)}}},o=r(27378),a=function(e){var t=(0,o.useRef)(void 0);return(0,o.useEffect)((function(){var r=function(r){var n;null!==(n=t.current)&&void 0!==n&&n.contains(r.target)||e()};return document.addEventListener("mousedown",r),function(){document.removeEventListener("mousedown",r)}}),[t,e]),{ref:t}}},36653:function(e,t,r){"use strict";r.d(t,{V:function(){return c}});var n=r(90849),s=r(28841),i=r(24246);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=function(){var e=(0,s.pmc)();return{errorAlert:function(t,r,n){var o=a(a({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,i.jsxs)(s.bZj,{alignItems:"normal",status:"error",children:[(0,i.jsx)(s.zMQ,{}),(0,i.jsxs)(s.xuv,{children:[r&&(0,i.jsx)(s.CdC,{children:r}),(0,i.jsx)(s.XaZ,{children:t})]}),(0,i.jsx)(s.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,o):e(o)},successAlert:function(t,r,n){var o=a(a({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,i.jsxs)(s.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,i.jsx)(s.zMQ,{}),(0,i.jsxs)(s.xuv,{children:[r&&(0,i.jsx)(s.CdC,{children:r}),(0,i.jsx)(s.XaZ,{children:t})]}),(0,i.jsx)(s.PZ7,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,o):e(o)}}}},2458:function(e,t,r){"use strict";var n=r(90849),s=r(28841),i=r(24246);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.Z=function(e){var t=e.isOpen,r=e.onClose,n=e.onConfirm,o=e.onCancel,c=e.title,l=e.message,d=e.cancelButtonText,u=e.cancelButtonThemingProps,h=e.continueButtonText,p=e.continueButtonThemingProps,f=e.isLoading,m=e.returnFocusOnClose,x=e.isCentered,j=e.testId,b=void 0===j?"confirmation-modal":j,g=e.icon;return(0,i.jsxs)(s.u_l,{isOpen:t,onClose:r,size:"lg",returnFocusOnClose:null===m||void 0===m||m,isCentered:x,children:[(0,i.jsx)(s.ZAr,{}),(0,i.jsxs)(s.hzk,{textAlign:"center",p:6,"data-testid":b,children:[g?(0,i.jsx)(s.M5Y,{mb:2,children:g}):null,c?(0,i.jsx)(s.xBx,{fontWeight:"medium",pb:0,children:c}):null,l?(0,i.jsx)(s.fef,{children:l}):null,(0,i.jsx)(s.mzw,{children:(0,i.jsxs)(s.MIq,{columns:2,width:"100%",children:[(0,i.jsx)(s.zxk,a(a({variant:"outline",mr:3,onClick:function(){o&&o(),r()},"data-testid":"cancel-btn",isDisabled:f},u),{},{children:d||"Cancel"})),(0,i.jsx)(s.zxk,a(a({colorScheme:"primary",onClick:n,"data-testid":"continue-btn",isLoading:f},p),{},{children:h||"Continue"}))]})})]})]})}},56069:function(e,t,r){"use strict";r.d(t,{R:function(){return p}});var n=r(90849),s=r(90089),i=r(28841),o=r(79894),a=r.n(o),c=r(24246),l=["backPath"],d=["onClick"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(e){var t=e.onClick,r=(0,s.Z)(e,d);return(0,c.jsxs)(i.kCb,h(h({alignItems:"center",mt:-4,mb:3,onClick:t,cursor:"pointer"},r),{},{children:[(0,c.jsx)(i.hU,{"aria-label":"Back",icon:(0,c.jsx)(i.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,c.jsx)(i.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]}))};t.Z=function(e){var t=e.backPath,r=(0,s.Z)(e,l);return(0,c.jsxs)(i.kCb,h(h({alignItems:"center",mb:6},r),{},{children:[(0,c.jsx)(a(),{href:t,passHref:!0,children:(0,c.jsx)(i.hU,{"aria-label":"Back",icon:(0,c.jsx)(i.Rpv,{}),mr:2,size:"xs",variant:"outline"})}),(0,c.jsx)(a(),{href:t,passHref:!0,children:(0,c.jsx)(i.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},13861:function(e,t,r){"use strict";r.d(t,{R:function(){return C},Z:function(){return S}});var n=r(28841),s=r(27378),i=r(33571),o=r.n(i),a=r(24246),c=function(e){var t=e.columns,r=e.items,s=e.renderItem,i=(0,n.yo_)(r,t);return(0,a.jsx)(n.xuv,{children:i.map((function(e,r,i){var c=i.length;return(0,a.jsx)(n.xuv,{className:o()["grid-row"],borderBottomWidth:c>1&&r===c-1&&e.length===t?"0.5px":void 0,children:(0,a.jsx)(n.MIq,{columns:t,children:e.map((function(e){return(0,a.jsx)(n.xuv,{className:o()["grid-item"],children:s(e)},JSON.stringify(e))}))})},JSON.stringify(e))}))})},l=r(44845),d=r(55732),u=r(97865),h=r(34707),p=r.n(h),f=r(79894),m=r.n(f),x=r(86677),j=r(6848),b=r(2458),g=r(60709),y=r(63238),v=r(4938),w=r(78624),O=r(24753),P=r(51860),k=function(e){var t=e.system,r=(0,n.qY0)(),s=r.isOpen,i=r.onOpen,o=r.onClose,c=(0,n.pmc)(),l=(0,j.T)(),h=(0,x.useRouter)(),f=(0,P.DW)(),k=(0,u.Z)(f,1)[0],C=function(){var e=(0,d.Z)(p().mark((function e(){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t.fides_key);case 2:r=e.sent,(0,w.D4)(r)?c((0,O.Vo)((0,w.e$)(r.error))):c((0,O.t5)("Successfully deleted system")),o();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=""===t.name||null==t.name?t.fides_key:t.name;return(0,a.jsxs)(n.xuv,{display:"flex","data-testid":"system-".concat(t.fides_key),children:[(0,a.jsx)(m(),{href:"".concat(g.So,"/configure/").concat(t.fides_key),passHref:!0,children:(0,a.jsxs)(n.xuv,{flexGrow:1,p:4,"data-testid":"system-box",_hover:{cursor:"pointer"},children:[(0,a.jsx)(n.X6q,{as:"h2",fontSize:"16px",mb:2,children:S}),(0,a.jsx)(n.xuv,{color:"gray.600",fontSize:"14px",children:(0,a.jsx)(n.xvT,{children:t.description})})]})}),(0,a.jsxs)(n.v2r,{children:[(0,a.jsx)(n.j2t,{as:n.hU,icon:(0,a.jsx)(n.nXP,{}),"aria-label":"more actions",variant:"unstyled",size:"sm","data-testid":"more-btn",m:1}),(0,a.jsxs)(n.qyq,{children:[(0,a.jsx)(n.sNh,{onClick:function(){l((0,P.db)(t)),h.push("".concat(g.So,"/configure/").concat(t.fides_key))},"data-testid":"edit-btn",children:"Edit"}),(0,a.jsx)(y.ZP,{scopes:[v.Sh.SYSTEM_DELETE],children:(0,a.jsx)(n.sNh,{onClick:i,"data-testid":"delete-btn",children:"Delete"})})]})]}),(0,a.jsx)(b.Z,{isOpen:s,onClose:o,onConfirm:C,title:"Delete ".concat(S),message:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.xvT,{children:["You are about to permanently delete the system"," ",(0,a.jsx)(n.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:S}),"."]}),(0,a.jsx)(n.xvT,{children:"Are you sure you would like to continue?"})]})})]})},C=function(e,t){var r,n;return(null===(r=e.name)||void 0===r?void 0:r.toLocaleLowerCase().includes(t.toLocaleLowerCase()))||(null===(n=e.description)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase()))},S=function(e){var t=e.systems,r=(0,s.useState)(""),i=r[0],o=r[1],d=(0,s.useMemo)((function(){return t?t.filter((function(e){return C(e,i)})):[]}),[t,i]);return t&&t.length?(0,a.jsxs)(n.xuv,{"data-testid":"system-management",children:[(0,a.jsx)(n.xuv,{mb:4,"data-testid":"system-filters",children:(0,a.jsx)(l.Z,{search:i,onChange:o,maxWidth:"30vw",placeholder:"Search system name or description","data-testid":"system-search",withIcon:!0})}),(0,a.jsx)(c,{columns:3,items:d,renderItem:function(e){return(0,a.jsx)(k,{system:e})}})]}):(0,a.jsx)("div",{"data-testid":"empty-state",children:"No systems registered."})}},72086:function(e,t,r){"use strict";var n=r(28841),s=(r(27378),r(51471)),i=r(56069),o=r(60709),a=r(24246);t.Z=function(e){var t=e.children;return(0,a.jsxs)(s.Z,{title:"User Management",children:[(0,a.jsx)(i.Z,{backPath:o.e3}),(0,a.jsx)(n.X6q,{fontSize:"2xl",fontWeight:"semibold",children:"User Management"}),t]})}},44127:function(e,t,r){"use strict";r.d(t,{Z:function(){return le}});var n=r(90849),s=r(90089),i=r(28841),o=r(75834),a=r(24246),c=function(){return(0,a.jsxs)(i.xuv,{children:[(0,a.jsx)(i.xuv,{pb:4,fontSize:"18px",fontWeight:"semibold",children:"Role Description"}),(0,a.jsx)(i.gCW,{spacing:4,children:o.K.map((function(e){return(0,a.jsxs)(i.xuv,{width:"100%",padding:4,borderRadius:"md",backgroundColor:"blue.50",fontSize:"14px",children:[(0,a.jsx)(i.xuv,{fontWeight:"semibold",children:e.label}),(0,a.jsx)(i.xuv,{color:"gray.500",children:e.description})]},e.roleKey)}))})]})},l=r(6848),d=r(44204),u=r(4938),h=r(63238),p=r(55732),f=r(97865),m=r(34707),x=r.n(m),j=r(34090),b=r(79894),g=r.n(b),y=r(27378),v=r(78624),w=r(2458),O=r(60709),P=r(38687),k=r(24753),C=r(44845),S=r(48466),z=r(13861),_=r(73679),Z=r(96156),D=r(30002),E=function(e){var t=e.assignedSystems,r=e.onAssignedSystemChange,n=(0,l.C)(D.Ux);if((0,D.d6)(n,{skip:!n}),0===t.length)return null;return(0,a.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,a.jsx)(i.hrZ,{children:(0,a.jsxs)(i.Tr,{children:[(0,a.jsx)(i.Th,{children:"System"}),(0,a.jsx)(i.Th,{})]})}),(0,a.jsx)(i.p3B,{children:t.map((function(e){return(0,a.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,a.jsx)(i.Td,{children:e.name}),(0,a.jsx)(i.Td,{textAlign:"end",children:(0,a.jsx)(i.hU,{background:"gray.50","aria-label":"Unassign system from user",icon:(0,a.jsx)(Z.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){r(t.filter((function(t){return t.fides_key!==e.fides_key})))}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},A=function(e){var t=e.allSystems,r=e.assignedSystems,n=e.onChange,s=function(e){var t=!!r.find((function(t){return t.fides_key===e.fides_key}));n(t?r.filter((function(t){return t.fides_key!==e.fides_key})):[].concat((0,_.Z)(r),[e]))};return(0,a.jsx)(i.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,a.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,a.jsx)(i.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,a.jsxs)(i.Tr,{children:[(0,a.jsx)(i.Th,{children:"System"}),(0,a.jsx)(i.Th,{children:"Assign"})]})}),(0,a.jsx)(i.p3B,{children:t.map((function(e){var t=!!r.find((function(t){return t.fides_key===e.fides_key}));return(0,a.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,a.jsx)(i.Td,{children:e.name}),(0,a.jsx)(i.Td,{children:(0,a.jsx)(i.rsf,{isChecked:t,onChange:function(){return s(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},T=function(e){var t=e.isOpen,r=e.onClose,n=e.assignedSystems,s=e.onAssignedSystemChange,o=(0,S.K3)().data,c=(0,y.useState)(""),l=c[0],d=c[1],u=(0,y.useState)(n),h=u[0],f=u[1],m=function(){var e=(0,p.Z)(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(h),r();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=!o||0===o.length,b=(0,y.useMemo)((function(){return o?o.filter((function(e){return(0,z.R)(e,l)})):[]}),[o,l]),g=(0,y.useMemo)((function(){var e=new Set(h.map((function(e){return e.fides_key})));return b.every((function(t){return e.has(t.fides_key)}))}),[b,h]);return(0,a.jsxs)(i.u_l,{isOpen:t,onClose:r,size:"2xl",children:[(0,a.jsx)(i.ZAr,{}),(0,a.jsxs)(i.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,a.jsxs)(i.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)(i.xvT,{children:"Assign systems"}),(0,a.jsxs)(i.Cts,{bg:"green.500",color:"white",px:1,children:["Assigned to ",n.length," systems"]})]}),(0,a.jsx)(i.fef,{"data-testid":"assign-systems-modal-body",children:j?(0,a.jsx)(i.xvT,{children:"No systems found"}):(0,a.jsxs)(i.Kqy,{spacing:4,children:[(0,a.jsxs)(i.kCb,{justifyContent:"space-between",children:[(0,a.jsx)(i.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Assign systems in your organization to this user"}),(0,a.jsx)(i.xuv,{children:(0,a.jsxs)(i.NIc,{display:"flex",alignItems:"center",children:[(0,a.jsx)(i.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,a.jsx)(i.rsf,{size:"sm",id:"assign-all-systems",isChecked:g,onChange:function(e){if(e.target.checked&&o)f(b);else{var t=o?o.filter((function(e){return!b.includes(e)})):[];f(t)}},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,a.jsx)(C.Z,{search:l,onChange:d,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,a.jsx)(A,{allSystems:b,assignedSystems:h,onChange:f})]})}),(0,a.jsx)(i.mzw,{justifyContent:"flex-start",children:(0,a.jsxs)(i.hE2,{size:"sm",children:[(0,a.jsx)(i.zxk,{variant:"outline",mr:2,onClick:r,"data-testid":"cancel-btn",children:"Cancel"}),j?null:(0,a.jsx)(i.zxk,{colorScheme:"primary",onClick:m,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},R=function(e){var t=e.label,r=e.roleKey,n=e.isSelected,s=e.isDisabled,o=e.assignedSystems,c=e.onAssignedSystemChange,l=(0,j.u6)().setFieldValue,d=(0,i.qY0)(),h=s?"You do not have sufficient permissions to assign this role.":void 0;return n?(0,a.jsxs)(i.Kqy,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",p:4,backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:[(0,a.jsxs)(i.kCb,{alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(i.xvT,{fontSize:"md",fontWeight:"semibold",children:t}),(0,a.jsx)(i.StI,{})]}),r!==u.A7.APPROVER?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.kCb,{alignItems:"center",children:[(0,a.jsx)(i.xvT,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"Assigned systems"}),(0,a.jsx)(P.Z,{label:"Assigned systems refer to those systems that have been specifically allocated to a user for management purposes. Users assigned to a system possess full edit permissions and are listed as the Data Steward for the respective system."})]}),(0,a.jsx)(i.zxk,{disabled:s,title:h,colorScheme:"primary",size:"xs",width:"fit-content",onClick:d.onOpen,"data-testid":"assign-systems-btn",children:"Assign systems +"}),(0,a.jsx)(E,{assignedSystems:o,onAssignedSystemChange:c}),d.isOpen?(0,a.jsx)(T,{isOpen:d.isOpen,onClose:d.onClose,assignedSystems:o,onAssignedSystemChange:c}):null]}):null]}):(0,a.jsx)(i.zxk,{onClick:function(){l("roles",[r])},justifyContent:"start",variant:"outline",height:"inherit",p:4,"data-testid":"role-option-".concat(t),title:h,disabled:s,children:t})};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var V={roles:[]},U=function(){var e,t=(0,i.pmc)(),r=(0,l.C)(D.Ux);(0,D.d6)(r,{skip:!r});var s=(0,i.qY0)(),c=s.isOpen,d=s.onOpen,m=s.onClose,b=(0,l.C)(D.R$),C=(0,y.useState)(b),S=C[0],z=C[1],_=(0,D.G$)(),Z=(0,f.Z)(_,1)[0];(0,y.useEffect)((function(){z(b)}),[b]);var E=(0,D.gU)(null!==r&&void 0!==r?r:"",{skip:!r}),A=E.data,T=E.isLoading,U=(0,D.lD)(),q=(0,f.Z)(U,1)[0],W=function(){var e=(0,p.Z)(x().mark((function e(n){var s,i,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&m(),r){e.next=3;break}return e.abrupt("return");case 3:return s=n.roles.includes(u.A7.APPROVER),e.next=6,q({user_id:r,payload:{roles:n.roles}});case 6:if(i=e.sent,!(0,v.D4)(i)){e.next=10;break}return t((0,k.Vo)((0,v.e$)(i.error))),e.abrupt("return");case 10:if(s){e.next=18;break}return o=S.map((function(e){return e.fides_key})),e.next=14,Z({userId:r,fidesKeys:o});case 14:if(a=e.sent,!(0,v.D4)(a)){e.next=18;break}return t((0,k.Vo)((0,v.e$)(a.error))),e.abrupt("return");case 18:t((0,k.t5)("Permissions updated"));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,p.Z)(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(!(S.length>0&&t.roles.includes(u.A7.APPROVER))){e.next=6;break}d(),e.next=8;break;case 6:return e.next=8,W(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=(0,h.Tg)([u.Sh.USER_PERMISSION_ASSIGN_OWNERS]);if(!r)return null;if(T)return(0,a.jsx)(i.$jN,{});if(!N&&null!==A&&void 0!==A&&null!==(e=A.roles)&&void 0!==e&&e.includes(u.A7.OWNER))return(0,a.jsx)(i.xvT,{"data-testid":"insufficient-access",children:"You do not have sufficient access to change this user's permissions."});var B=null!==A&&void 0!==A&&A.roles?{roles:A.roles}:V;return(0,a.jsx)(j.J9,{onSubmit:L,initialValues:B,enableReinitialize:!0,children:function(e){var t=e.values,r=e.isSubmitting,s=e.dirty;return(0,a.jsxs)(j.l0,{children:[(0,a.jsxs)(i.Kqy,{spacing:7,children:[(0,a.jsxs)(i.Kqy,{spacing:3,"data-testid":"role-options",children:[(0,a.jsxs)(i.kCb,{alignItems:"center",children:[(0,a.jsx)(i.xvT,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"User role"}),(0,a.jsx)(P.Z,{label:"A user's role in the organization determines what parts of the UI they can access and which functions are available to them."})]}),o.K.map((function(e){var r=t.roles.indexOf(e.roleKey)>=0;return(0,a.jsx)(R,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSelected:r,isDisabled:e.roleKey===u.A7.OWNER&&!N,assignedSystems:S,onAssignedSystemChange:z},e),e.roleKey)}))]}),(0,a.jsxs)(i.hE2,{size:"sm",children:[(0,a.jsx)(g(),{href:O.e3,passHref:!0,children:(0,a.jsx)(i.zxk,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(i.zxk,{colorScheme:"primary",type:"submit",isLoading:r,disabled:!s&&S===b,"data-testid":"save-btn",children:"Save"})]})]}),(0,a.jsx)(w.Z,{isOpen:c,onClose:m,onConfirm:function(){return W(t)},title:"Change role to Approver",testId:"downgrade-to-approver-confirmation-modal",continueButtonText:"Yes",message:(0,a.jsx)(i.xvT,{children:"Switching to an approver role will remove all assigned systems. Do you wish to proceed?"})})]})}})},q=r(9408),W=r(78098),L=r(14633),N=r(43139),B=L.Z_().required().min(8,"Password must have at least eight characters.").matches(/[0-9]/,"Password must have at least one number.").matches(/[A-Z]/,"Password must have at least one capital letter.").matches(/[a-z]/,"Password must have at least one lowercase letter.").matches(/[\W_]/,"Password must have at least one symbol."),K=r(45802),Y=r(33167);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=L.Ry().shape({password:B.label("Password"),passwordConfirmation:L.Z_().required().oneOf([L.iH("password")],"Passwords must match").label("Password confirmation")}),$={password:"",passwordConfirmation:""},G=function(e){var t=function(e){var t=(0,i.qY0)(),r=(0,i.pmc)(),n=(0,D.ls)(),s=(0,f.Z)(n,1)[0],o=function(){var n=(0,p.Z)(x().mark((function n(i){var o;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s({id:e,new_password:i.password});case 2:o=n.sent,(0,Y.isErrorResult)(o)?r((0,k.Vo)((0,v.e$)(o.error))):(r((0,k.t5)("Successfully reset user's password. Please inform the user of their new password.")),t.onClose());case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return H(H({},t),{},{handleResetPassword:o})}(e.id),r=t.handleResetPassword,n=t.isOpen,s=t.onClose,o=t.onOpen;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zxk,{variant:"outline",size:"sm",onClick:o,"data-testid":"reset-password-btn",children:"Reset password"}),(0,a.jsxs)(i.u_l,{isCentered:!0,isOpen:n,onClose:s,children:[(0,a.jsx)(i.ZAr,{}),(0,a.jsx)(i.hzk,{children:(0,a.jsx)(j.J9,{initialValues:$,validationSchema:F,onSubmit:r,children:function(e){var t=e.isSubmitting,r=e.dirty,n=e.isValid;return(0,a.jsxs)(j.l0,{children:[(0,a.jsx)(i.xBx,{children:"Reset Password"}),(0,a.jsx)(i.olH,{}),(0,a.jsx)(i.fef,{children:(0,a.jsxs)(i.Kqy,{direction:"column",spacing:4,children:[(0,a.jsx)(i.xvT,{mb:2,children:"Choose a new password for this user."}),(0,a.jsx)(N.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}),(0,a.jsx)(N.j0,{name:"passwordConfirmation",label:"Confirm Password",placeholder:"********",type:"password",tooltip:"Must match above password."})]})}),(0,a.jsx)(i.mzw,{children:(0,a.jsxs)(i.hE2,{size:"sm",spacing:"2",width:"100%",children:[(0,a.jsx)(i.zxk,{onClick:s,variant:"outline",width:"50%",children:"Cancel"}),(0,a.jsx)(i.zxk,{colorScheme:"primary",disabled:!r||!n,isLoading:t,type:"submit",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})})]})}})})]})]})};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(e){var t=function(e){var t=(0,i.qY0)(),r=(0,i.pmc)(),n=(0,y.useState)(""),s=n[0],o=n[1],a=(0,y.useState)(""),c=a[0],l=a[1],d=(0,D.ev)(),u=(0,f.Z)(d,2),h=u[0],m=u[1].isLoading,j=!!(e&&c&&s),b=function(){var n=(0,p.Z)(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:j&&h({id:e,old_password:s,new_password:c}).unwrap().then((function(){r((0,k.t5)("Password updated")),t.onClose()}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return J(J({},t),{},{changePasswordValidation:j,handleChange:function(e){"oldPassword"===e.target.name?o(e.target.value):l(e.target.value)},handleChangePassword:b,isLoading:m,newPasswordValue:c,oldPasswordValue:s})}(e.id),r=t.changePasswordValidation,n=t.handleChange,s=t.handleChangePassword,o=t.isLoading,c=t.isOpen,l=t.newPasswordValue,d=t.oldPasswordValue,u=t.onClose,h=t.onOpen;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zxk,{variant:"outline",size:"sm",onClick:h,"data-testid":"update-password-btn",children:"Update password"}),(0,a.jsxs)(i.u_l,{isCentered:!0,isOpen:c,onClose:u,children:[(0,a.jsx)(i.ZAr,{}),(0,a.jsxs)(i.hzk,{children:[(0,a.jsx)(i.xBx,{children:"Update Password"}),(0,a.jsx)(i.olH,{}),(0,a.jsx)(i.fef,{pb:6,children:(0,a.jsxs)(i.Kqy,{direction:"column",spacing:"15px",children:[(0,a.jsx)(i.NIc,{children:(0,a.jsx)(i.IIB,{isRequired:!0,name:"oldPassword",onChange:n,placeholder:"Old Password",type:"password",value:d,"data-testid":"input-oldPassword"})}),(0,a.jsx)(i.NIc,{children:(0,a.jsx)(i.IIB,{isRequired:!0,name:"newPassword",onChange:n,placeholder:"New Password",type:"password",value:l,"data-testid":"input-newPassword"})})]})}),(0,a.jsxs)(i.mzw,{children:[(0,a.jsx)(i.zxk,{bg:"white",marginRight:"10px",onClick:u,size:"sm",variant:"solid",width:"50%",children:"Cancel"}),(0,a.jsx)(i.zxk,{bg:"primary.800",color:"white",disabled:!r,isLoading:o,mr:3,onClick:s,size:"sm",type:"submit",variant:"solid",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})]})]})]})},ee=function(){var e=(0,l.C)(D.Ux),t=(0,l.C)(K.dy),r=!!t&&t.id===e;return(0,a.jsx)(i.xuv,{children:e?(0,a.jsxs)(i.Ugi,{children:[r?(0,a.jsx)(Q,{id:e}):null,(0,a.jsx)(h.ZP,{scopes:[u.Sh.USER_PASSWORD_RESET],children:(0,a.jsx)(G,{id:e})})]}):null})};function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ne={username:"",first_name:"",last_name:"",password:""},se=L.Ry().shape({username:L.Z_().required().label("Username"),first_name:L.Z_().label("First name"),last_name:L.Z_().label("Last name"),password:B.label("Password")}),ie=function(e){var t=e.onSubmit,r=e.initialValues,n=e.canEditNames,s=(0,i.pmc)(),o=(0,l.T)(),c=(0,i.qY0)(),d=(0,q.HK)().handleError,u=(0,l.C)(D.ZC),h=!u,f=!h&&!n,m=function(){var e=(0,p.Z)(x().mark((function e(r){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(r);case 2:if(!(n=e.sent)||!("error"in n)){e.next=6;break}return d(n.error),e.abrupt("return");case 6:s((0,k.t5)("".concat(h?"User created. By default, new users are set to the Viewer role. To change the role, please go to the Permissions tab.":"User updated."))),n&&n.data&&o((0,D.Vv)(n.data.id));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=h?se:se.omit(["password"]);return(0,a.jsx)(j.J9,{onSubmit:m,initialValues:null!==r&&void 0!==r?r:ne,validationSchema:b,children:function(e){var t=e.dirty,r=e.isSubmitting,n=e.isValid;return(0,a.jsx)(j.l0,{children:(0,a.jsxs)(i.Kqy,{maxW:["xs","xs","100%"],width:"100%",spacing:7,children:[(0,a.jsxs)(i.Kqy,{spacing:6,maxWidth:"55%",children:[(0,a.jsxs)(i.kCb,{children:[(0,a.jsx)(i.xvT,{display:"flex",alignItems:"center",fontSize:"sm",fontWeight:"semibold",children:"Profile"}),(0,a.jsx)(i.xuv,{marginLeft:"auto",children:(0,a.jsxs)(i.Ugi,{children:[(0,a.jsx)(ee,{}),h?null:(0,a.jsxs)(i.xuv,{children:[(0,a.jsx)(i.hU,{"aria-label":"delete",icon:(0,a.jsx)(Z.l,{}),variant:"outline",size:"sm",onClick:c.onOpen,"data-testid":"delete-user-btn"}),(0,a.jsx)(W.Z,re({user:u},c))]})]})})]}),(0,a.jsx)(N.j0,{name:"username",label:"Username",variant:"block",placeholder:"Enter new username",disabled:!h,isRequired:!0}),(0,a.jsx)(N.j0,{name:"first_name",label:"First Name",variant:"block",placeholder:"Enter first name of user",disabled:f}),(0,a.jsx)(N.j0,{name:"last_name",label:"Last Name",variant:"block",placeholder:"Enter last name of user",disabled:f}),u?null:(0,a.jsx)(N.j0,{name:"password",label:"Password",variant:"block",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol.",isRequired:!0})]}),(0,a.jsxs)(i.hE2,{size:"sm",children:[(0,a.jsx)(g(),{href:O.e3,passHref:!0,children:(0,a.jsx)(i.zxk,{variant:"outline",mr:3,children:"Cancel"})}),(0,a.jsx)(i.zxk,{type:"submit",bg:"primary.800",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},colorScheme:"primary",disabled:!t||!n,isLoading:r,"data-testid":"save-user-btn",children:"Save"})]})]})})}})},oe=["onSubmit","initialValues"];function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=function(e){var t=e.onSubmit,r=e.initialValues,n=(0,s.Z)(e,oe),o=(0,l.C)(D.Ux);(0,D.Fk)(o,{skip:!o});var p=(0,h.Tg)([u.Sh.USER_PERMISSION_UPDATE]),f=!o||!p,m=[{label:"Profile",content:(0,a.jsx)(ie,ce({onSubmit:t,initialValues:r},n))},{label:"Permissions",content:(0,a.jsxs)(i.kCb,{gap:"97px",children:[(0,a.jsx)(i.xuv,{w:{base:"100%",md:"50%",xl:"50%"},children:(0,a.jsx)(U,{})}),(0,a.jsx)(i.xuv,{position:"absolute",top:"96px",right:6,height:"calc(100% + 100px)",overflowY:"scroll",padding:6,w:"35%",borderLeftWidth:"1px",children:(0,a.jsx)(c,{})})]}),isDisabled:f}];return(0,a.jsx)(d.Z,{data:m})}},33167:function(e,t,r){"use strict";r.d(t,{isAPIError:function(){return n.Bw},isErrorResult:function(){return n.D4}});var n=r(60041)},33571:function(e){e.exports={"grid-row":"BorderGrid_grid-row__gzSVf","grid-item":"BorderGrid_grid-item__7gUTW"}}}]);