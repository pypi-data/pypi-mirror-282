import{d as T,aF as z,ae as k,f,o as c,z as K,v as R,l as n,m as l,bp as D,c as d,bq as N,a as v,br as $,bs as A,bt as G,bu as J,bv as L,az as q,e as H,bw as M,an as O,bx as Q,by as W,bz as X,bA as Y,g as u,i as y,k as Z,ah as C,bB as ee,bC as le,bD as te,bE as se,bF as ae,bG as ne,bH as oe,bI as ue,bJ as F,a5 as re,bo as U,bK as ie}from"./index-DmG-an2w.js";import{u as fe}from"./usePageTitle-dvSfGJr8.js";const ce={class:"flow-run-graphs__graph-panel-container"},pe={class:"flow-run-graphs__graphs"},de={class:"flow-run-graphs__panel p-background"},ve=T({__name:"FlowRunGraphs",props:{flowRun:{}},setup(S){const g=z(),m=k(),s=k(!1),e=k(null),_=f(()=>{var r,t;return{root:{"flow-run-graphs--fullscreen":s.value,"flow-run-graphs--show-panel":((r=e.value)==null?void 0:r.kind)==="task-run"||((t=e.value)==null?void 0:t.kind)==="flow-run"}}}),p=async({nodeId:r,since:t,until:i})=>{const b={anyResource:{id:[`prefect.flow-run.${r}`]},event:{excludePrefix:["prefect.log.write","prefect.task-run."]},occurred:{since:t,until:i}},{events:w}=await g.events.getEvents(b);return w};return(r,t)=>{var i,b,w;return c(),K("div",{class:q(["flow-run-graphs",_.value.root])},[R("div",ce,[R("div",pe,[n(l(D),{fullscreen:s.value,"onUpdate:fullscreen":t[0]||(t[0]=a=>s.value=a),viewport:m.value,"onUpdate:viewport":t[1]||(t[1]=a=>m.value=a),selected:e.value,"onUpdate:selected":t[2]||(t[2]=a=>e.value=a),"flow-run":r.flowRun,"fetch-events":p,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),R("div",de,[((i=e.value)==null?void 0:i.kind)==="task-run"||((b=e.value)==null?void 0:b.kind)==="flow-run"?(c(),d(l(N),{key:0,selection:e.value,"onUpdate:selection":t[3]||(t[3]=a=>e.value=a),floating:s.value},null,8,["selection","floating"])):v("",!0)])]),e.value&&e.value.kind==="event"?(c(),d(l($),{key:0,selection:e.value,"onUpdate:selection":t[4]||(t[4]=a=>e.value=a)},null,8,["selection"])):v("",!0),e.value&&e.value.kind==="events"?(c(),d(l(A),{key:1,selection:e.value,"onUpdate:selection":t[5]||(t[5]=a=>e.value=a)},null,8,["selection"])):v("",!0),e.value&&e.value.kind==="artifacts"?(c(),d(l(G),{key:2,selection:e.value,"onUpdate:selection":t[6]||(t[6]=a=>e.value=a)},null,8,["selection"])):v("",!0),((w=e.value)==null?void 0:w.kind)==="state"?(c(),d(l(J),{key:3,selection:e.value,"onUpdate:selection":t[7]||(t[7]=a=>e.value=a)},null,8,["selection"])):v("",!0),n(l(L),{selection:e.value,"onUpdate:selection":t[8]||(t[8]=a=>e.value=a)},null,8,["selection"])],2)}}}),me=T({__name:"FlowRun",setup(S){const g=Z(),m=H("flowRunId"),{flowRun:s,subscription:e}=M(m,{interval:5e3}),_=f(()=>{var o;return C(((o=s.value)==null?void 0:o.parameters)??{})}),p=f(()=>{var o;return(o=s.value)!=null&&o.stateType?ee(s.value.stateType):!0}),r=f(()=>{var o;return C(((o=s.value)==null?void 0:o.jobVariables)??{})}),t=f(()=>[{label:"Logs"},{label:"Task Runs",hidden:p.value},{label:"Subflow Runs",hidden:p.value},{label:"Results",hidden:p.value},{label:"Artifacts",hidden:p.value},{label:"Details"},{label:"Parameters"},{label:"Job Variables"}]),i=O("tab","Logs"),{tabs:b}=Q(t,i),w=f(()=>[m.value]),{filter:a}=W({flowRuns:{parentFlowRunId:w}});function E(){g.push(U.runs())}const j=f(()=>{var o;return(o=s.value)==null?void 0:o.stateType});X(j);const B=f(()=>s.value?`Flow Run: ${s.value.name}`:"Flow Run");return fe(B),Y(()=>{e.error&&ie(e.error).isInRange("clientError")&&g.replace(U[404]())}),(o,h)=>{const x=y("p-code-highlight"),I=y("p-tabs"),V=y("p-layout-default");return l(s)?(c(),d(V,{key:l(s).id,class:"flow-run"},{header:u(()=>[n(l(le),{"flow-run-id":l(s).id,onDelete:E},null,8,["flow-run-id"])]),default:u(()=>[p.value?v("",!0):(c(),d(ve,{key:0,"flow-run":l(s)},null,8,["flow-run"])),n(I,{selected:l(i),"onUpdate:selected":h[0]||(h[0]=P=>re(i)?i.value=P:null),tabs:l(b)},{details:u(()=>[n(l(te),{"flow-run":l(s)},null,8,["flow-run"])]),logs:u(()=>[n(l(se),{"flow-run":l(s)},null,8,["flow-run"])]),results:u(()=>[n(l(ae),{"flow-run":l(s)},null,8,["flow-run"])]),artifacts:u(()=>[n(l(ne),{"flow-run":l(s)},null,8,["flow-run"])]),"task-runs":u(()=>[n(l(oe),{"flow-run-id":l(s).id},null,8,["flow-run-id"])]),"subflow-runs":u(()=>[n(l(ue),{filter:l(a)},null,8,["filter"])]),parameters:u(()=>[n(l(F),{"text-to-copy":_.value},{default:u(()=>[n(x,{lang:"json",text:_.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])]),"job-variables":u(()=>[n(l(F),{"text-to-copy":r.value},{default:u(()=>[n(x,{lang:"json",text:r.value,class:"flow-run__job-variables"},null,8,["text"])]),_:1},8,["text-to-copy"])]),_:1},8,["selected","tabs"])]),_:1})):v("",!0)}}});export{me as default};
//# sourceMappingURL=FlowRun-Cv1TZK12.js.map
