import{g as d}from"./csrf.5.0.2.js";function m(){var n=document.getElementById("drop-area"),i=document.getElementById("fileElem"),a=document.getElementById("progress-bar"),c=document.getElementById("upload-status");n&&(n.onclick=function(){i.click()},n.addEventListener("dragover",function(t){t.preventDefault(),n.classList.add("bg-info")}),n.addEventListener("dragleave",function(t){n.classList.remove("bg-info")}),n.addEventListener("drop",function(t){t.preventDefault(),n.classList.remove("bg-info");let o=t.dataTransfer.files;o.length&&l(o[0])}),i.onchange=function(){this.files.length&&l(this.files[0])});function l(t){f(t)}function f(t){let o=new FormData;o.append("file",t);let e=new XMLHttpRequest;e.open("POST","../upload/",!0),e.setRequestHeader("X-CSRFToken",d()),e.upload.onprogress=function(s){if(s.lengthComputable){let r=s.loaded/s.total*100;a.style.width=r+"%",a.setAttribute("aria-valuenow",r),a.innerHTML=r.toFixed(0)+"%",r>99&&(c.innerHTML="Upload complete. Parsing and saving to S3...")}},e.onload=function(){e.status===200?window.location.href="../":console.error("Error:",e.statusText)},e.onerror=function(){console.error("Error:",e.statusText)},e.send(o)}document.getElementById("test-connection-btn").addEventListener("click",function(){var t=document.getElementById("db-connection-form"),o=new FormData(t);fetch("../../validate/",{method:"POST",body:o,headers:{"X-CSRFToken":d()}}).then(e=>e.json()).then(e=>{e.success?alert("Connection successful!"):alert("Connection failed: "+e.error)}).catch(e=>console.error("Error:",e))})}export{m as setupUploads};
