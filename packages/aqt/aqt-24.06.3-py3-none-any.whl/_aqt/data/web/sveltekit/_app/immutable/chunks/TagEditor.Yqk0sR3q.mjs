import{S as ne,i as se,s as le,e as U,c as G,F as I,M as R,h as N,ad as lt,P as H,R as Ie,a7 as Ye,n as J,f as S,y as ye,l as Ke,T as de,a5 as vt,U as Tt,ab as ot,Q as q,V as te,Y as ee,I as we,B as P,a as K,b as Y,C as j,g as O,D as W,j as ge,J as $e,K as Se,L as ve,v,r as T,E as M,A as mn,t as V,d as F,G as Ct,H as yt,q as be,u as ke,$ as ue,a0 as fe,k as We,ac as _n,N as Le,z as Nt,a3 as hn,W as at,_ as pn}from"./Component.C0CSGRj9.mjs";import{e as Ve,u as bn,o as kn}from"./each.AJyTDN0I.mjs";import"./index.HrFqG6o2.mjs";import{A as wn}from"./backend.dXWO455a.mjs";import{r as $n,s as Sn,t as vn,e as At,S as Re,b as je,I as Fe,v as Tn,w as Cn,o as it,x as yn,y as Nn,z as An,A as Dn,B as En,f as In,i as Pn}from"./Shortcut.FTojhkHY.mjs";import{d as jn,w as Dt}from"./index.YmSRfxF3.mjs";import{r as Wn}from"./runtime-require.2UnWAaTy.mjs";import{g as Et,a as Mn}from"./cross-browser.a5UeKJFq.mjs";import{bk as rt,bl as Bn,bm as Hn,bn as zn}from"./ftl.IxHLS1AB.mjs";import{W as It,P as Pt,D as Ge,B as Rn}from"./Badge.nHU7HYX0.mjs";import{W as qn}from"./WithTooltip.tBPuR1Py.mjs";import{p as Ln}from"./theme.FGcaMnTR.mjs";const bl=Symbol("fontFamily"),kl=Symbol("fontSize"),wl=Symbol("direction"),$l=Symbol("collapsed"),Xe=Symbol("tagActionsShortcuts");function Vn(t,e,n){document.execCommand(t,e,n)}function Sl(t){return document.queryCommandState(t)}function jt(t,e,n){if(!t.parentNode||t===e)return n;{const s=t.parentNode,o=[Array.prototype.indexOf.call(t.parentNode.childNodes,t),...n];return jt(s,e,o)}}function ut(t,e){return jt(t,e,[])}function Ze(t,e){if(e.length===0)return t;if(t.childNodes[e[0]]){const[n,...s]=e;return Ze(t.childNodes[n],s)}else return null}var xe=(t=>(t[t.Before=-1]="Before",t[t.Equal=0]="Equal",t[t.After=1]="After",t))(xe||{});function Fn(t,e){const n=Math.min(t.coordinates.length,e.coordinates.length);for(let s=0;s<=n;s++){if(t.coordinates.length===s)return e.coordinates.length===s?t.offset<e.offset?-1:t.offset>e.offset?1:0:-1;if(e.coordinates.length===s)return 1;if(t.coordinates[s]<e.coordinates[s])return-1;if(t.coordinates[s]>e.coordinates[s])return 1}throw new Error("compareLocations: Should never happen")}function Kn(t){const e=Et(t),n=Mn(e);if(!n)return null;const s=n.collapsed,i={coordinates:ut(e.anchorNode,t),offset:e.anchorOffset};if(s)return{anchor:i,collapsed:s};const l={coordinates:ut(e.focusNode,t),offset:e.focusOffset},f=Fn(i,l)===xe.After?"backward":"forward";return{anchor:i,focus:l,collapsed:s,direction:f}}function On(t){t.empty()}function Un(t,e,n,s){const o=s.focus,i=o.offset,r=Ze(t,o.coordinates);s.direction==="forward"?(n.setEnd(r,i),e.addRange(n)):(e.addRange(n),e.extend(r,i))}function Gn(t){return Kn(t)}function Jn(t,e){const n=Et(t);On(n);const s=new Range,o=Ze(t,e.anchor.coordinates);s.setStart(o,e.anchor.offset),e.collapsed?(s.collapse(!0),n.addRange(s)):Un(t,n,s,e)}Wn("anki/location",{Position:xe,restoreSelection:Jn,saveSelection:Gn});const ae="âˆ·";function Qe(t){return t.replace(/::/g,ae)}function qe(t){return t.replace(/\u2237/gu,"::")}function ft(t){let e=t.trim();for(;e.startsWith(":")||e.startsWith(ae);)e=e.slice(1).trimStart();for(;e.endsWith(":")||e.endsWith(ae);)e=e.slice(0,-1).trimEnd();return e}function Je(t){return{id:Math.random().toString(36).substring(2),name:t,selected:!1,flash:()=>{}}}function Qn(t){return t.name}function Yn(t){let e,n,s,o;return{c(){e=U("input"),this.h()},l(i){e=G(i,"INPUT",{id:!0,class:!0,type:!0,tabindex:!0,size:!0}),this.h()},h(){I(e,"id",t[2]),I(e,"class",n="tag-input "+t[3]+" svelte-1nk8ij0"),I(e,"type","text"),I(e,"tabindex","-1"),I(e,"size","1"),R(e,"disabled",t[4])},m(i,r){N(i,e,r),t[14](e),lt(e,t[0]),s||(o=[H(e,"input",t[15]),H(e,"focus",t[11]),H(e,"blur",Ie(t[6])),H(e,"keydown",t[7]),H(e,"keydown",t[12]),H(e,"keyup",t[13]),H(e,"input",t[16]),H(e,"copy",Ie(t[8])),H(e,"paste",Ie(t[9])),Ye(t[10].call(null,e))],s=!0)},p(i,r){r[0]&4&&I(e,"id",i[2]),r[0]&8&&n!==(n="tag-input "+i[3]+" svelte-1nk8ij0")&&I(e,"class",n),r[0]&1&&e.value!==i[0]&&lt(e,i[0]),r[0]&24&&R(e,"disabled",i[4])},i:J,o:J,d(i){i&&S(e),t[14](null),s=!1,ye(o)}}}const Pe=Dt(null),vl=jn(Pe,t=>()=>t==null?void 0:t.blur());function Xn(t,e,n){let s,o=J;Ke(t,Pe,_=>n(17,s=_)),t.$$.on_destroy.push(()=>o());let{id:i=void 0}=e,{class:r=""}=e,{name:l}=e,{input:a}=e,{disabled:f}=e;const g=de();function p(){return a.selectionStart===a.selectionEnd}function c(){return a.selectionStart===0&&a.selectionEnd===0}function b(){return a.selectionStart===a.value.length&&a.selectionEnd===a.value.length}function d(_){a.setSelectionRange(_,_)}function h(){return l.length===0}async function m(_){const L=a.value.length;g("tagjoinprevious"),await ee(),d(a.value.length-L),_.preventDefault()}async function D(_,L){if(L>l.length)return;l.slice(0,L).endsWith(ae)&&(n(0,l=l.slice(0,L-1)+l.slice(L,l.length)),await ee(),_.preventDefault(),d(L-1),g("taginput"))}function A(_){c()?m(_):D(_,a.selectionStart)}async function E(_){const L=a.value.length;g("tagjoinnext"),await ee(),d(L),_.preventDefault()}function w(_){b()?E(_):D(_,a.selectionStart+2)}function $(){n(0,l=ft(l)),l.length===0&&g("tagdelete"),g("tagaccept")}function B(_){g("tagsplit",{start:a.selectionStart,end:a.selectionEnd}),_.preventDefault()}async function z(_,L=!1){const oe=a.selectionStart,ce=a.selectionEnd,x=l.slice(0,oe),De=l.slice(ce,l.length);if(x.endsWith(ae)){_.preventDefault(),_.stopPropagation();return}else if(x.endsWith(":")){_.preventDefault(),n(0,l=`${x.slice(0,-1)}${ae}${l.slice(ce,l.length)}`),await ee(),d(oe),g("taginput");return}else if(De.startsWith(":"))_.preventDefault(),n(0,l=`${x}${ae}${l.slice(ce+1,l.length)}`);else{if(L)return;_.preventDefault(),n(0,l=`${x}${ae}${De}`)}await ee(),d(oe+1),g("taginput")}function Z(_){switch(_.code){case"Enter":B(_);break;case"Backspace":p()&&A(_);break;case"Delete":p()&&w(_);break}Sn(_)?h()?m(_):c()&&(g("tagmoveprevious"),_.preventDefault()):vn(_)?h()?E(_):b()&&(g("tagmovenext"),_.preventDefault()):_.key===" "?z(_,!1):_.key===":"&&z(_,!0)}function ie(_){const L=document.getSelection();_.clipboardData.setData("text/plain",qe(L.toString()))}function C(_){if(!_.clipboardData)return;const oe=(l+_.clipboardData.getData("text/plain")).split(/\s+/).map(ft).filter(x=>x.length>0).map(Qe);if(oe.length===0)return;const ce=oe.pop();for(const x of oe.reverse())n(0,l=x),g("tagadd");n(0,l=ce)}function X(_){l.length===0&&(_.preventDefault(),_.stopPropagation(),g("tagselectall"))}const{selectAllShortcut:re}=vt(Xe);Tt(()=>{$n(X,re,{target:a}),a.focus()});function Ne(_){return ot(Pe,s=_,s),{destroy(){s===_&&ot(Pe,s=null,s)}}}function Ae(_){q.call(this,t,_)}function me(_){q.call(this,t,_)}function Te(_){q.call(this,t,_)}function _e(_){te[_?"unshift":"push"](()=>{a=_,n(1,a)})}function Ce(){l=this.value,n(0,l)}const y=()=>g("taginput");return t.$$set=_=>{"id"in _&&n(2,i=_.id),"class"in _&&n(3,r=_.class),"name"in _&&n(0,l=_.name),"input"in _&&n(1,a=_.input),"disabled"in _&&n(4,f=_.disabled)},[l,a,i,r,f,g,$,Z,ie,C,Ne,Ae,me,Te,_e,Ce,y]}class Zn extends ne{constructor(e){super(),se(this,e,Xn,Yn,le,{id:2,class:3,name:0,input:1,disabled:4},null,[-1,-1])}}function xn(t){let e,n,s,o;return e=new Fe({props:{icon:Tn}}),s=new Fe({props:{icon:Cn}}),{c(){P(e.$$.fragment),n=K(),P(s.$$.fragment)},l(i){j(e.$$.fragment,i),n=O(i),j(s.$$.fragment,i)},m(i,r){W(e,i,r),N(i,n,r),W(s,i,r),o=!0},p:J,i(i){o||(v(e.$$.fragment,i),v(s.$$.fragment,i),o=!0)},o(i){T(e.$$.fragment,i),T(s.$$.fragment,i),o=!1},d(i){i&&S(n),M(e,i),M(s,i)}}}function es(t){let e,n,s,o,i,r,l,a,f,g,p;n=new At({props:{$$slots:{default:[xn]},$$scope:{ctx:t}}});const c=t[4].default,b=we(c,t,t[6],null);return a=new Re({props:{keyCombination:t[0]}}),a.$on("action",t[5]),{c(){e=U("div"),P(n.$$.fragment),s=K(),o=U("span"),b&&b.c(),l=K(),P(a.$$.fragment),this.h()},l(d){e=G(d,"DIV",{class:!0,title:!0,role:!0,tabindex:!0});var h=Y(e);j(n.$$.fragment,h),s=O(h),o=G(h,"SPAN",{class:!0});var m=Y(o);b&&b.l(m),m.forEach(S),h.forEach(S),l=O(d),j(a.$$.fragment,d),this.h()},h(){I(o,"class","tags-info svelte-1fo7hj6"),I(e,"class","tag-add-button svelte-1fo7hj6"),I(e,"title",i=rt()+" ("+je(t[0])+")"),I(e,"role","button"),I(e,"tabindex",r=t[1]?-1:0)},m(d,h){N(d,e,h),W(n,e,null),ge(e,s),ge(e,o),b&&b.m(o,null),N(d,l,h),W(a,d,h),f=!0,g||(p=[H(e,"click",t[3]),H(e,"focus",t[3])],g=!0)},p(d,[h]){const m={};h&64&&(m.$$scope={dirty:h,ctx:d}),n.$set(m),b&&b.p&&(!f||h&64)&&$e(b,c,d,d[6],f?ve(c,d[6],h,null):Se(d[6]),null),(!f||h&1&&i!==(i=rt()+" ("+je(d[0])+")"))&&I(e,"title",i),(!f||h&2&&r!==(r=d[1]?-1:0))&&I(e,"tabindex",r);const D={};h&1&&(D.keyCombination=d[0]),a.$set(D)},i(d){f||(v(n.$$.fragment,d),v(b,d),v(a.$$.fragment,d),f=!0)},o(d){T(n.$$.fragment,d),T(b,d),T(a.$$.fragment,d),f=!1},d(d){d&&(S(e),S(l)),M(n),b&&b.d(d),M(a,d),g=!1,ye(p)}}}function ts(t,e,n){let s;Ke(t,Pe,g=>n(1,s=g));let{$$slots:o={},$$scope:i}=e,{keyCombination:r}=e;const l=de();function a(){l("tagappend")}const f=()=>l("tagappend");return t.$$set=g=>{"keyCombination"in g&&n(0,r=g.keyCombination),"$$scope"in g&&n(6,i=g.$$scope)},[r,s,l,a,o,f,i]}class ns extends ne{constructor(e){super(),se(this,e,ts,es,le,{keyCombination:0})}}function ss(t){let e,n;return e=new Fe({props:{icon:yn}}),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p:J,i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function ls(t){let e,n,s,o,i;return n=new At({props:{$$slots:{default:[ss]},$$scope:{ctx:t}}}),{c(){e=U("div"),P(n.$$.fragment),this.h()},l(r){e=G(r,"DIV",{class:!0,role:!0,tabindex:!0});var l=Y(e);j(n.$$.fragment,l),l.forEach(S),this.h()},h(){I(e,"class","tags-selected-button svelte-y9jxqs"),I(e,"role","button"),I(e,"tabindex","0")},m(r,l){N(r,e,l),W(n,e,null),s=!0,o||(i=[Ye(t[10].call(null,e)),H(e,"click",t[8]),H(e,"keydown",function(){mn(it(t[9]))&&it(t[9]).apply(this,arguments)})],o=!0)},p(r,l){t=r;const a={};l&2048&&(a.$$scope={dirty:l,ctx:t}),n.$set(a)},i(r){s||(v(n.$$.fragment,r),s=!0)},o(r){T(n.$$.fragment,r),s=!1},d(r){r&&S(e),M(n),o=!1,ye(i)}}}function os(t){let e=Bn()+"",n,s,o=je(t[2])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=F(l,e),s=F(l," ("),i=F(l,o),r=F(l,")")},m(l,a){N(l,n,a),N(l,s,a),N(l,i,a),N(l,r,a)},p:J,d(l){l&&(S(n),S(s),S(i),S(r))}}}function as(t){let e=Hn()+"",n,s,o=je(t[3])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=F(l,e),s=F(l," ("),i=F(l,o),r=F(l,")")},m(l,a){N(l,n,a),N(l,s,a),N(l,i,a),N(l,r,a)},p:J,d(l){l&&(S(n),S(s),S(i),S(r))}}}function is(t){let e=zn()+"",n,s,o=je(t[4])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=F(l,e),s=F(l," ("),i=F(l,o),r=F(l,")")},m(l,a){N(l,n,a),N(l,s,a),N(l,i,a),N(l,r,a)},p:J,d(l){l&&(S(n),S(s),S(i),S(r))}}}function rs(t){let e,n,s,o,i,r;return e=new Ge({props:{$$slots:{default:[os]},$$scope:{ctx:t}}}),e.$on("click",t[5]),s=new Ge({props:{$$slots:{default:[as]},$$scope:{ctx:t}}}),s.$on("click",t[6]),i=new Ge({props:{$$slots:{default:[is]},$$scope:{ctx:t}}}),i.$on("click",t[7]),{c(){P(e.$$.fragment),n=K(),P(s.$$.fragment),o=K(),P(i.$$.fragment)},l(l){j(e.$$.fragment,l),n=O(l),j(s.$$.fragment,l),o=O(l),j(i.$$.fragment,l)},m(l,a){W(e,l,a),N(l,n,a),W(s,l,a),N(l,o,a),W(i,l,a),r=!0},p(l,a){const f={};a&2048&&(f.$$scope={dirty:a,ctx:l}),e.$set(f);const g={};a&2048&&(g.$$scope={dirty:a,ctx:l}),s.$set(g);const p={};a&2048&&(p.$$scope={dirty:a,ctx:l}),i.$set(p)},i(l){r||(v(e.$$.fragment,l),v(s.$$.fragment,l),v(i.$$.fragment,l),r=!0)},o(l){T(e.$$.fragment,l),T(s.$$.fragment,l),T(i.$$.fragment,l),r=!1},d(l){l&&(S(n),S(o)),M(e,l),M(s,l),M(i,l)}}}function us(t){let e,n;return e=new Pt({props:{slot:"floating",$$slots:{default:[rs]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,o){const i={};o&2048&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function fs(t){let e,n;return e=new It({props:{show:t[0],preferredPlacement:"top",portalTarget:document.body,shift:0,$$slots:{floating:[us],default:[ls,({asReference:s})=>({10:s}),({asReference:s})=>s?1024:0]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.show=s[0]),o&2049&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function cs(t,e,n){const s=de();let o=!1;const{selectAllShortcut:i,copyShortcut:r,removeShortcut:l}=vt(Xe);return[o,s,i,r,l,()=>s("tagselectall"),()=>s("tagcopy"),()=>s("tagdelete"),()=>n(0,o=!o),()=>n(0,o=!o)]}class gs extends ne{constructor(e){super(),se(this,e,cs,fs,le,{})}}function ds(t){let e,n;return e=new ns({props:{keyCombination:t[2]}}),e.$on("tagappend",t[7]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,o){const i={};o&4&&(i.keyCombination=s[2]),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function ms(t){let e,n;return e=new gs({}),e.$on("tagselectall",t[4]),e.$on("tagcopy",t[5]),e.$on("tagdelete",t[6]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p:J,i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function _s(t){let e,n,s,o,i,r,l;const a=[ms,ds],f=[];function g(p,c){return p[1]?0:1}return n=g(t),s=f[n]=a[n](t),{c(){e=U("div"),s.c(),this.h()},l(p){e=G(p,"DIV",{class:!0});var c=Y(e);s.l(c),c.forEach(S),this.h()},h(){I(e,"class","tag-options-button gap svelte-16efk4p"),Ct(()=>t[8].call(e))},m(p,c){N(p,e,c),f[n].m(e,null),o=yt(e,t[8].bind(e)),i=!0,r||(l=H(e,"mousedown",Ie(t[3])),r=!0)},p(p,[c]){let b=n;n=g(p),n===b?f[n].p(p,c):(be(),T(f[b],1,1,()=>{f[b]=null}),ke(),s=f[n],s?s.p(p,c):(s=f[n]=a[n](p),s.c()),v(s,1),s.m(e,null))},i(p){i||(v(s),i=!0)},o(p){T(s),i=!1},d(p){p&&S(e),f[n].d(),o(),r=!1,l()}}}function hs(t,e,n){let{badgeHeight:s}=e,{tagsSelected:o}=e,{keyCombination:i}=e;function r(c){q.call(this,t,c)}function l(c){q.call(this,t,c)}function a(c){q.call(this,t,c)}function f(c){q.call(this,t,c)}function g(c){q.call(this,t,c)}function p(){s=this.offsetHeight,n(0,s)}return t.$$set=c=>{"badgeHeight"in c&&n(0,s=c.badgeHeight),"tagsSelected"in c&&n(1,o=c.tagsSelected),"keyCombination"in c&&n(2,i=c.keyCombination)},[s,o,i,r,l,a,f,g,p]}class ps extends ne{constructor(e){super(),se(this,e,hs,_s,le,{badgeHeight:0,tagsSelected:1,keyCombination:2})}}function bs(t){let e,n;return e=new Fe({props:{icon:Nn}}),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p:J,i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function ks(t){let e,n;return e=new Rn({props:{class:"d-flex align-items-center ms-1 "+t[0],iconSize:80,$$slots:{default:[bs]},$$scope:{ctx:t}}}),e.$on("click",t[1]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.class="d-flex align-items-center ms-1 "+s[0]),o&4&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function ws(t,e,n){let{class:s=""}=e;function o(i){q.call(this,t,i)}return t.$$set=i=>{"class"in i&&n(0,s=i.class)},[s,o]}class $s extends ne{constructor(e){super(),se(this,e,ws,ks,le,{class:0})}}function Ss(t){let e,n,s,o,i;const r=t[8].default,l=we(r,t,t[7],null);return{c(){e=U("button"),l&&l.c(),this.h()},l(a){e=G(a,"BUTTON",{class:!0,tabindex:!0,title:!0,"data-addon-tag":!0});var f=Y(e);l&&l.l(f),f.forEach(S),this.h()},h(){I(e,"class",n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+t[0]+" svelte-1ywoj88"),I(e,"tabindex","-1"),I(e,"title",t[2]),I(e,"data-addon-tag",t[1]),R(e,"selected",t[3]),R(e,"flashing",t[4])},m(a,f){N(a,e,f),l&&l.m(e,null),t[11](e),s=!0,o||(i=[H(e,"mousemove",t[9]),H(e,"click",t[10])],o=!0)},p(a,[f]){l&&l.p&&(!s||f&128)&&$e(l,r,a,a[7],s?ve(r,a[7],f,null):Se(a[7]),null),(!s||f&1&&n!==(n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+a[0]+" svelte-1ywoj88"))&&I(e,"class",n),(!s||f&4)&&I(e,"title",a[2]),(!s||f&2)&&I(e,"data-addon-tag",a[1]),(!s||f&9)&&R(e,"selected",a[3]),(!s||f&17)&&R(e,"flashing",a[4])},i(a){s||(v(l,a),s=!0)},o(a){T(l,a),s=!1},d(a){a&&S(e),l&&l.d(a),t[11](null),o=!1,ye(i)}}}function vs(t,e,n){let{$$slots:s={},$$scope:o}=e,{class:i=""}=e,{tagName:r}=e,{tooltip:l=void 0}=e,{selected:a=!1}=e;const f=de();let g=!1;function p(){n(4,g=!0),setTimeout(()=>n(4,g=!1),300)}let c;Tt(()=>f("mount",{button:c}));function b(m){q.call(this,t,m)}function d(m){q.call(this,t,m)}function h(m){te[m?"unshift":"push"](()=>{c=m,n(5,c)})}return t.$$set=m=>{"class"in m&&n(0,i=m.class),"tagName"in m&&n(1,r=m.tagName),"tooltip"in m&&n(2,l=m.tooltip),"selected"in m&&n(3,a=m.selected),"$$scope"in m&&n(7,o=m.$$scope)},[i,r,l,a,g,c,p,o,s,b,d,h]}class et extends ne{constructor(e){super(),se(this,e,vs,Ss,le,{class:0,tagName:1,tooltip:2,selected:3,flash:6})}get flash(){return this.$$.ctx[6]}}const Ts=t=>({selectMode:t&128}),ct=t=>({selectMode:t[7],hoverClass:tt}),Cs=t=>({selectMode:t&128}),gt=t=>({selectMode:t[7],hoverClass:tt}),ys=t=>({selectMode:t&128}),dt=t=>({selectMode:t[7],hoverClass:tt});function Ns(t){let e,n,s,o;function i(a){t[19](a)}function r(a){t[20](a)}let l={class:t[3],tagName:t[2],$$slots:{default:[Es]},$$scope:{ctx:t}};return t[1]!==void 0&&(l.flash=t[1]),t[0]!==void 0&&(l.selected=t[0]),e=new et({props:l}),te.push(()=>ue(e,"flash",i)),te.push(()=>ue(e,"selected",r)),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){P(e.$$.fragment)},l(a){j(e.$$.fragment,a)},m(a,f){W(e,a,f),o=!0},p(a,f){const g={};f&8&&(g.class=a[3]),f&4&&(g.tagName=a[2]),f&2097284&&(g.$$scope={dirty:f,ctx:a}),!n&&f&2&&(n=!0,g.flash=a[1],fe(()=>n=!1)),!s&&f&1&&(s=!0,g.selected=a[0],fe(()=>s=!1)),e.$set(g)},i(a){o||(v(e.$$.fragment,a),o=!0)},o(a){T(e.$$.fragment,a),o=!1},d(a){M(e,a)}}}function As(t){let e,n;return e=new qn({props:{tooltip:t[4],trigger:"hover",placement:"top",$$slots:{default:[Ps,({createTooltip:s})=>({23:s}),({createTooltip:s})=>s?8388608:0]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,o){const i={};o&16&&(i.tooltip=s[4]),o&10485903&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Ds(t){let e,n;return e=new et({props:{class:t[3],tagName:t[2],$$slots:{default:[js]},$$scope:{ctx:t}}}),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,o){const i={};o&8&&(i.class=s[3]),o&4&&(i.tagName=s[2]),o&2097284&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Es(t){let e,n,s,o;const i=t[15].default,r=we(i,t,t[21],ct);return{c(){e=U("span"),n=V(t[2]),s=K(),r&&r.c()},l(l){e=G(l,"SPAN",{});var a=Y(e);n=F(a,t[2]),a.forEach(S),s=O(l),r&&r.l(l)},m(l,a){N(l,e,a),ge(e,n),N(l,s,a),r&&r.m(l,a),o=!0},p(l,a){(!o||a&4)&&We(n,l[2]),r&&r.p&&(!o||a&2097280)&&$e(r,i,l,l[21],o?ve(i,l[21],a,Ts):Se(l[21]),ct)},i(l){o||(v(r,l),o=!0)},o(l){T(r,l),o=!1},d(l){l&&(S(e),S(s)),r&&r.d(l)}}}function Is(t){let e,n=t[11](t[2])+"",s,o,i;const r=t[15].default,l=we(r,t,t[21],gt);return{c(){e=U("span"),s=V(n),o=K(),l&&l.c()},l(a){e=G(a,"SPAN",{});var f=Y(e);s=F(f,n),f.forEach(S),o=O(a),l&&l.l(a)},m(a,f){N(a,e,f),ge(e,s),N(a,o,f),l&&l.m(a,f),i=!0},p(a,f){(!i||f&4)&&n!==(n=a[11](a[2])+"")&&We(s,n),l&&l.p&&(!i||f&2097280)&&$e(l,r,a,a[21],i?ve(r,a[21],f,Cs):Se(a[21]),gt)},i(a){i||(v(l,a),i=!0)},o(a){T(l,a),i=!1},d(a){a&&(S(e),S(o)),l&&l.d(a)}}}function Ps(t){let e,n,s,o;function i(f){t[16](f)}function r(f){t[17](f)}function l(...f){return t[18](t[23],...f)}let a={class:t[3],tagName:t[2],$$slots:{default:[Is]},$$scope:{ctx:t}};return t[1]!==void 0&&(a.flash=t[1]),t[0]!==void 0&&(a.selected=t[0]),e=new et({props:a}),te.push(()=>ue(e,"flash",i)),te.push(()=>ue(e,"selected",r)),e.$on("mousemove",t[9]),e.$on("click",t[10]),e.$on("mount",l),{c(){P(e.$$.fragment)},l(f){j(e.$$.fragment,f)},m(f,g){W(e,f,g),o=!0},p(f,g){t=f;const p={};g&8&&(p.class=t[3]),g&4&&(p.tagName=t[2]),g&2097284&&(p.$$scope={dirty:g,ctx:t}),!n&&g&2&&(n=!0,p.flash=t[1],fe(()=>n=!1)),!s&&g&1&&(s=!0,p.selected=t[0],fe(()=>s=!1)),e.$set(p)},i(f){o||(v(e.$$.fragment,f),o=!0)},o(f){T(e.$$.fragment,f),o=!1},d(f){M(e,f)}}}function js(t){let e,n,s;const o=t[15].default,i=we(o,t,t[21],dt);return{c(){e=V(t[2]),n=K(),i&&i.c()},l(r){e=F(r,t[2]),n=O(r),i&&i.l(r)},m(r,l){N(r,e,l),N(r,n,l),i&&i.m(r,l),s=!0},p(r,l){(!s||l&4)&&We(e,r[2]),i&&i.p&&(!s||l&2097280)&&$e(i,o,r,r[21],s?ve(o,r[21],l,ys):Se(r[21]),dt)},i(r){s||(v(i,r),s=!0)},o(r){T(i,r),s=!1},d(r){r&&(S(e),S(n)),i&&i.d(r)}}}function Ws(t){let e,n,s,o,i,r,l,a;const f=[Ds,As,Ns],g=[];function p(c,b){return b&68&&(s=null),c[5]?0:(s==null&&(s=!!(c[6]&&c[12](c[2]))),s?1:2)}return o=p(t,-1),i=g[o]=f[o](t),{c(){e=K(),n=U("div"),i.c(),this.h()},l(c){e=O(c),n=G(c,"DIV",{class:!0});var b=Y(n);i.l(b),b.forEach(S),this.h()},h(){I(n,"class","svelte-11ejbji"),R(n,"select-mode",t[7]),R(n,"night-mode",t[8].isDark),R(n,"empty",t[2]==="")},m(c,b){N(c,e,b),N(c,n,b),g[o].m(n,null),r=!0,l||(a=[H(document.body,"keydown",t[9]),H(document.body,"keyup",t[9])],l=!0)},p(c,[b]){let d=o;o=p(c,b),o===d?g[o].p(c,b):(be(),T(g[d],1,1,()=>{g[d]=null}),ke(),i=g[o],i?i.p(c,b):(i=g[o]=f[o](c),i.c()),v(i,1),i.m(n,null)),(!r||b&128)&&R(n,"select-mode",c[7]),(!r||b&256)&&R(n,"night-mode",c[8].isDark),(!r||b&4)&&R(n,"empty",c[2]==="")},i(c){r||(v(i),r=!0)},o(c){T(i),r=!1},d(c){c&&(S(e),S(n)),g[o].d(),l=!1,ye(a)}}}const tt="tag-icon-hover";function Ms(t,e,n){let s,o;Ke(t,Ln,C=>n(8,o=C));let{$$slots:i={},$$scope:r}=e,{name:l}=e,{class:a=""}=e,{tooltip:f}=e,{selected:g}=e,{active:p}=e,{shorten:c}=e,{flash:b}=e;const d=de();let h=!1,m=!1;function D(C){n(13,h=An(C)),n(14,m=Dn(C))}function A(){d(m?"tagrange":h?"tagselect":"tagclick")}function E(C){const X=C.split(ae);return X.length===1?C:`â€¦${ae}`+X[X.length-1]}function w(C){return C.split(ae).length>1}function $(C){b=C,n(1,b)}function B(C){g=C,n(0,g)}const z=(C,X)=>C(X.detail.button);function Z(C){b=C,n(1,b)}function ie(C){g=C,n(0,g)}return t.$$set=C=>{"name"in C&&n(2,l=C.name),"class"in C&&n(3,a=C.class),"tooltip"in C&&n(4,f=C.tooltip),"selected"in C&&n(0,g=C.selected),"active"in C&&n(5,p=C.active),"shorten"in C&&n(6,c=C.shorten),"flash"in C&&n(1,b=C.flash),"$$scope"in C&&n(21,r=C.$$scope)},t.$$.update=()=>{t.$$.dirty&24576&&n(7,s=h||m)},[g,b,l,a,f,p,c,s,o,D,A,E,w,h,m,i,$,B,z,Z,ie,r]}class Bs extends ne{constructor(e){super(),se(this,e,Ms,Ws,le,{name:2,class:3,tooltip:4,selected:0,active:5,shorten:6,flash:1})}}function Hs(t){let e,n;function s(){return t[9](t[13])}return e=new $s({props:{class:t[14]}}),e.$on("click",s),{c(){P(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,i){W(e,o,i),n=!0},p(o,i){t=o;const r={};i&16384&&(r.class=t[14]),e.$set(r)},i(o){n||(v(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){M(e,o)}}}function zs(t){let e,n;return e=new Bs({props:{name:t[0],class:t[1],tooltip:t[2],selected:t[3],active:t[4],shorten:t[5],flash:t[6],$$slots:{default:[Hs,({selectMode:s,hoverClass:o})=>({13:s,14:o}),({selectMode:s,hoverClass:o})=>(s?8192:0)|(o?16384:0)]},$$scope:{ctx:t}}}),e.$on("tagrange",t[10]),e.$on("tagselect",t[11]),e.$on("tagclick",t[12]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.name=s[0]),o&2&&(i.class=s[1]),o&4&&(i.tooltip=s[2]),o&8&&(i.selected=s[3]),o&16&&(i.active=s[4]),o&32&&(i.shorten=s[5]),o&64&&(i.flash=s[6]),o&57344&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Rs(t,e,n){let{name:s}=e,{class:o=""}=e,{tooltip:i}=e,{selected:r}=e,{active:l}=e,{shorten:a}=e,{flash:f}=e;const g=de();function p(){g("tagdelete")}const c=m=>{m||p()};function b(m){q.call(this,t,m)}function d(m){q.call(this,t,m)}const h=()=>g("tagedit");return t.$$set=m=>{"name"in m&&n(0,s=m.name),"class"in m&&n(1,o=m.class),"tooltip"in m&&n(2,i=m.tooltip),"selected"in m&&n(3,r=m.selected),"active"in m&&n(4,l=m.active),"shorten"in m&&n(5,a=m.shorten),"flash"in m&&n(6,f=m.flash)},[s,o,i,r,l,a,f,g,p,c,b,d,h]}class qs extends ne{constructor(e){super(),se(this,e,Rs,zs,le,{name:0,class:1,tooltip:2,selected:3,active:4,shorten:5,flash:6})}}function Ls(t){let e,n="<br/>",s,o;return{c(){e=U("div"),e.innerHTML=n,this.h()},l(i){e=G(i,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),_n(e)!=="svelte-1t8945d"&&(e.innerHTML=n),this.h()},h(){I(e,"class","tag-spacer svelte-1k3couf"),I(e,"role","textbox"),I(e,"tabindex","-1")},m(i,r){N(i,e,r),s||(o=H(e,"click",t[0]),s=!0)},p:J,i:J,o:J,d(i){i&&S(e),s=!1,o()}}}function Vs(t){function e(n){q.call(this,t,n)}return[e]}class Fs extends ne{constructor(e){super(),se(this,e,Vs,Ls,le,{})}}function Ks(t){let e,n,s,o;const i=t[5].default,r=we(i,t,t[4],null);return{c(){e=U("div"),r&&r.c(),this.h()},l(l){e=G(l,"DIV",{tabindex:!0,class:!0,"data-addon-suggestion":!0});var a=Y(e);r&&r.l(a),a.forEach(S),this.h()},h(){I(e,"tabindex","-1"),I(e,"class","autocomplete-item svelte-1pjq6zk"),I(e,"data-addon-suggestion",t[2]),R(e,"selected",t[0]),R(e,"active",t[1])},m(l,a){N(l,e,a),r&&r.m(e,null),t[10](e),n=!0,s||(o=[H(e,"mousedown",Ie(t[6])),H(e,"mouseup",t[7]),H(e,"mouseenter",t[8]),H(e,"mouseleave",t[9])],s=!0)},p(l,[a]){r&&r.p&&(!n||a&16)&&$e(r,i,l,l[4],n?ve(i,l[4],a,null):Se(l[4]),null),(!n||a&4)&&I(e,"data-addon-suggestion",l[2]),(!n||a&1)&&R(e,"selected",l[0]),(!n||a&2)&&R(e,"active",l[1])},i(l){n||(v(r,l),n=!0)},o(l){T(r,l),n=!1},d(l){l&&S(e),r&&r.d(l),t[10](null),s=!1,ye(o)}}}function Os(t,e,n){let{$$slots:s={},$$scope:o}=e,{selected:i=!1}=e,{active:r=!1}=e,{suggestion:l}=e,a;function f(d){q.call(this,t,d)}function g(d){q.call(this,t,d)}function p(d){q.call(this,t,d)}function c(d){q.call(this,t,d)}function b(d){te[d?"unshift":"push"](()=>{a=d,n(3,a)})}return t.$$set=d=>{"selected"in d&&n(0,i=d.selected),"active"in d&&n(1,r=d.active),"suggestion"in d&&n(2,l=d.suggestion),"$$scope"in d&&n(4,o=d.$$scope)},t.$$.update=()=>{t.$$.dirty&9&&i&&a&&a.scrollIntoViewIfNeeded({behavior:"smooth",block:"start"})},[i,r,l,a,o,s,f,g,p,c,b]}class Wt extends ne{constructor(e){super(),se(this,e,Os,Ks,le,{selected:0,active:1,suggestion:2})}}const Us=t=>({}),mt=t=>({createAutocomplete:t[6]});function _t(t,e,n){const s=t.slice();return s[30]=e[n],s[32]=n,s}function Gs(t){let e,n,s,o;const i=t[11].default,r=we(i,t,t[20],mt);return{c(){e=U("span"),r&&r.c(),this.h()},l(l){e=G(l,"SPAN",{class:!0});var a=Y(e);r&&r.l(a),a.forEach(S),this.h()},h(){I(e,"class","autocomplete-reference svelte-1bkz961")},m(l,a){N(l,e,a),r&&r.m(e,null),n=!0,s||(o=Ye(t[33].call(null,e)),s=!0)},p(l,a){r&&r.p&&(!n||a[0]&1048576)&&$e(r,i,l,l[20],n?ve(i,l[20],a,Us):Se(l[20]),mt)},i(l){n||(v(r,l),n=!0)},o(l){T(r,l),n=!1},d(l){l&&S(e),r&&r.d(l),s=!1,o()}}}function Js(t){let e,n;function s(){return t[16](t[32])}function o(){return t[17](t[32])}function i(...r){return t[18](t[32],...r)}return e=new Wt({props:{suggestion:t[30],$$slots:{default:[Ys]},$$scope:{ctx:t}}}),e.$on("mousedown",s),e.$on("mouseup",o),e.$on("mouseenter",i),{c(){P(e.$$.fragment)},l(r){j(e.$$.fragment,r)},m(r,l){W(e,r,l),n=!0},p(r,l){t=r;const a={};l[0]&2&&(a.suggestion=t[30]),l[0]&1048578&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){M(e,r)}}}function Qs(t){let e,n;function s(){return t[12](t[32])}function o(){return t[13](t[32])}function i(...r){return t[14](t[32],...r)}return e=new Wt({props:{selected:!0,active:t[3],suggestion:t[30],$$slots:{default:[Xs]},$$scope:{ctx:t}}}),e.$on("mousedown",s),e.$on("mouseup",o),e.$on("mouseenter",i),e.$on("mouseleave",t[15]),{c(){P(e.$$.fragment)},l(r){j(e.$$.fragment,r)},m(r,l){W(e,r,l),n=!0},p(r,l){t=r;const a={};l[0]&8&&(a.active=t[3]),l[0]&2&&(a.suggestion=t[30]),l[0]&1048578&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){M(e,r)}}}function Ys(t){let e=t[30]+"",n,s;return{c(){n=V(e),s=K()},l(o){n=F(o,e),s=O(o)},m(o,i){N(o,n,i),N(o,s,i)},p(o,i){i[0]&2&&e!==(e=o[30]+"")&&We(n,e)},d(o){o&&(S(n),S(s))}}}function Xs(t){let e=t[30]+"",n,s;return{c(){n=V(e),s=K()},l(o){n=F(o,e),s=O(o)},m(o,i){N(o,n,i),N(o,s,i)},p(o,i){i[0]&2&&e!==(e=o[30]+"")&&We(n,e)},d(o){o&&(S(n),S(s))}}}function ht(t){let e,n,s,o;const i=[Qs,Js],r=[];function l(a,f){return a[32]===a[2]?0:1}return e=l(t),n=r[e]=i[e](t),{c(){n.c(),s=at()},l(a){n.l(a),s=at()},m(a,f){r[e].m(a,f),N(a,s,f),o=!0},p(a,f){let g=e;e=l(a),e===g?r[e].p(a,f):(be(),T(r[g],1,1,()=>{r[g]=null}),ke(),n=r[e],n?n.p(a,f):(n=r[e]=i[e](a),n.c()),v(n,1),n.m(s.parentNode,s))},i(a){o||(v(n),o=!0)},o(a){T(n),o=!1},d(a){a&&S(s),r[e].d(a)}}}function Zs(t){let e,n,s=Ve(t[1]),o=[];for(let r=0;r<s.length;r+=1)o[r]=ht(_t(t,s,r));const i=r=>T(o[r],1,1,()=>{o[r]=null});return{c(){e=U("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=G(r,"DIV",{class:!0});var l=Y(e);for(let a=0;a<o.length;a+=1)o[a].l(l);l.forEach(S),this.h()},h(){I(e,"class","autocomplete-menu svelte-1bkz961")},m(r,l){N(r,e,l);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);n=!0},p(r,l){if(l[0]&942){s=Ve(r[1]);let a;for(a=0;a<s.length;a+=1){const f=_t(r,s,a);o[a]?(o[a].p(f,l),v(o[a],1)):(o[a]=ht(f),o[a].c(),v(o[a],1),o[a].m(e,null))}for(be(),a=s.length;a<o.length;a+=1)i(a);ke()}},i(r){if(!n){for(let l=0;l<s.length;l+=1)v(o[l]);n=!0}},o(r){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)T(o[l]);n=!1},d(r){r&&S(e),hn(o,r)}}}function xs(t){let e,n,s;return e=new Pt({props:{slot:"floating",$$slots:{default:[Zs]},$$scope:{ctx:t}}}),{c(){n=U("div"),P(e.$$.fragment),this.h()},l(o){n=G(o,"DIV",{style:!0});var i=Y(n);j(e.$$.fragment,i),this.h()},h(){Le(n,"display","contents"),Le(n,"--popover-padding-inline","0")},m(o,i){N(o,n,i),W(e,n,null),s=!0},p(o,i){const r={};i[0]&1048590&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(o){s||(v(e.$$.fragment,o),s=!0)},o(o){T(e.$$.fragment,o),s=!1},d(o){o&&e&&S(n),M(e,o)}}}function el(t){let e,n;return e=new It({props:{keepOnKeyup:!0,show:t[4],preferredPlacement:"top",portalTarget:document.body,$$slots:{floating:[xs],default:[Gs,({asReference:s})=>({33:s}),({asReference:s})=>[0,s?4:0]]},$$scope:{ctx:t}}}),e.$on("close",t[19]),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,o){W(e,s,o),n=!0},p(s,o){const i={};o[0]&16&&(i.show=s[4]),o[0]&1048590&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function tl(t,e,n){let s,o=J,i=()=>(o(),o=Nt(f,y=>n(4,s=y)),f);t.$$.on_destroy.push(()=>o());let{$$slots:r={},$$scope:l}=e,{suggestionsPromise:a}=e,{show:f}=e;i();let g=[],p=null,c=!1;const b=de();function d(){p===null?n(2,p=0):p>=g.length-1?n(2,p=null):n(2,p++,p)}function h(){p===null?n(2,p=g.length-1):p===0?n(2,p=null):n(2,p--,p)}async function m(){b("select",{selected:g[p??-1]})}async function D(){d(),await m()}async function A(){h(),await m()}async function E(){n(3,c=!0),b("choose",{chosen:g[p??-1]}),await ee(),f.set(!1)}async function w(){await ee(),b("update")}function $(){return p!==null}function B(){return{selectPrevious:A,selectNext:D,chooseSelected:E,update:w,hasSelected:$}}function z(y){n(2,p=y),n(3,c=!0)}function Z(y){z(y)}async function ie(y){n(3,c=!1),b("select",{selected:g[y]})}function C(y,_){y.buttons===1&&z(_)}const X=y=>Z(y),re=y=>{ie(y),E()},Ne=(y,_)=>C(_,y),Ae=()=>n(3,c=!1),me=y=>Z(y),Te=y=>{ie(y),E()},_e=(y,_)=>C(_,y),Ce=()=>f.set(!1);return t.$$set=y=>{"suggestionsPromise"in y&&n(10,a=y.suggestionsPromise),"show"in y&&i(n(0,f=y.show)),"$$scope"in y&&n(20,l=y.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1025&&a.then(y=>{f.set(y.length>0),En()&&navigator.userAgent.match(/Chrome\/77/)&&(y=y.slice(0,10)),n(1,g=y)})},[f,g,p,c,s,E,B,Z,ie,C,a,r,X,re,Ne,Ae,me,Te,_e,Ce,l]}class nl extends ne{constructor(e){super(),se(this,e,tl,el,le,{suggestionsPromise:10,show:0},null,[-1,-1])}}function pt(t,e,n){const s=t.slice();return s[75]=e[n],s[76]=e,s[77]=n,s}function bt(t){let e,n,s,o,i,r;return e=new Re({props:{keyCombination:Mt}}),e.$on("action",t[34]),s=new Re({props:{keyCombination:Bt}}),s.$on("action",t[35]),i=new Re({props:{keyCombination:Ht}}),i.$on("action",t[36]),{c(){P(e.$$.fragment),n=K(),P(s.$$.fragment),o=K(),P(i.$$.fragment)},l(l){j(e.$$.fragment,l),n=O(l),j(s.$$.fragment,l),o=O(l),j(i.$$.fragment,l)},m(l,a){W(e,l,a),N(l,n,a),W(s,l,a),N(l,o,a),W(i,l,a),r=!0},p:J,i(l){r||(v(e.$$.fragment,l),v(s.$$.fragment,l),v(i.$$.fragment,l),r=!0)},o(l){T(e.$$.fragment,l),T(s.$$.fragment,l),T(i.$$.fragment,l),r=!1},d(l){l&&(S(n),S(o)),M(e,l),M(s,l),M(i,l)}}}function kt(t){let e,n;function s(...o){return t[61](t[77],...o)}return e=new nl({props:{suggestionsPromise:t[7],show:t[14],$$slots:{default:[sl,({createAutocomplete:o})=>({78:o}),({createAutocomplete:o})=>[0,0,o?65536:0]]},$$scope:{ctx:t}}}),e.$on("update",t[17]),e.$on("select",t[60]),e.$on("choose",s),{c(){P(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,i){W(e,o,i),n=!0},p(o,i){t=o;const r={};i[0]&128&&(r.suggestionsPromise=t[7]),i[0]&7688|i[2]&196608&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(o){n||(v(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){M(e,o)}}}function sl(t){let e,n,s,o;function i(A){t[46](A)}function r(A){t[47](A)}function l(){return t[48](t[75],t[78])}function a(){return t[50](t[75])}function f(...A){return t[51](t[77],...A)}function g(){return t[52](t[77])}function p(){return t[53](t[77])}function c(){return t[55](t[77])}function b(){return t[56](t[77])}function d(){return t[57](t[77])}function h(){return t[58](t[77])}function m(){return t[59](t[75],t[77])}let D={id:t[75].id,class:"position-absolute start-0 top-0 bottom-0 ps-2 py-0",disabled:t[12]};return t[9]!==void 0&&(D.name=t[9]),t[10]!==void 0&&(D.input=t[10]),e=new Zn({props:D}),te.push(()=>ue(e,"name",i)),te.push(()=>ue(e,"input",r)),e.$on("focus",l),e.$on("keydown",t[29]),e.$on("keyup",t[49]),e.$on("taginput",a),e.$on("tagsplit",f),e.$on("tagadd",g),e.$on("tagdelete",p),e.$on("tagselectall",t[54]),e.$on("tagjoinprevious",c),e.$on("tagjoinnext",b),e.$on("tagmoveprevious",d),e.$on("tagmovenext",h),e.$on("tagaccept",m),{c(){P(e.$$.fragment)},l(A){j(e.$$.fragment,A)},m(A,E){W(e,A,E),o=!0},p(A,E){t=A;const w={};E[0]&8&&(w.id=t[75].id),E[0]&4096&&(w.disabled=t[12]),!n&&E[0]&512&&(n=!0,w.name=t[9],fe(()=>n=!1)),!s&&E[0]&1024&&(s=!0,w.input=t[10],fe(()=>s=!1)),e.$set(w)},i(A){o||(v(e.$$.fragment,A),o=!0)},o(A){T(e.$$.fragment,A),o=!1},d(A){M(e,A)}}}function wt(t,e){let n,s,o,i,r,l;function a(m){e[40](m,e[75])}function f(m){e[41](m,e[75])}function g(){return e[42](e[77])}function p(){return e[43](e[77])}function c(){return e[44](e[77])}function b(){return e[45](e[77])}let d={class:"ms-0",name:e[77]===e[8]?e[9]:e[75].name,tooltip:e[75].name,active:e[77]===e[8],shorten:e[6]};e[75].flash!==void 0&&(d.flash=e[75].flash),e[75].selected!==void 0&&(d.selected=e[75].selected),s=new qs({props:d}),te.push(()=>ue(s,"flash",a)),te.push(()=>ue(s,"selected",f)),s.$on("tagedit",g),s.$on("tagselect",p),s.$on("tagrange",c),s.$on("tagdelete",b);let h=e[77]===e[8]&&kt(e);return{key:t,first:null,c(){n=U("div"),P(s.$$.fragment),r=K(),h&&h.c(),this.h()},l(m){n=G(m,"DIV",{class:!0});var D=Y(n);j(s.$$.fragment,D),r=O(D),h&&h.l(D),D.forEach(S),this.h()},h(){I(n,"class","tag-relative svelte-1tsu84n"),R(n,"hide-tag",e[77]===e[8]),this.first=n},m(m,D){N(m,n,D),W(s,n,null),ge(n,r),h&&h.m(n,null),l=!0},p(m,D){e=m;const A={};D[0]&776&&(A.name=e[77]===e[8]?e[9]:e[75].name),D[0]&8&&(A.tooltip=e[75].name),D[0]&264&&(A.active=e[77]===e[8]),D[0]&64&&(A.shorten=e[6]),!o&&D[0]&8&&(o=!0,A.flash=e[75].flash,fe(()=>o=!1)),!i&&D[0]&8&&(i=!0,A.selected=e[75].selected,fe(()=>i=!1)),s.$set(A),e[77]===e[8]?h?(h.p(e,D),D[0]&264&&v(h,1)):(h=kt(e),h.c(),v(h,1),h.m(n,null)):h&&(be(),T(h,1,1,()=>{h=null}),ke()),(!l||D[0]&264)&&R(n,"hide-tag",e[77]===e[8])},i(m){l||(v(s.$$.fragment,m),v(h),l=!0)},o(m){T(s.$$.fragment,m),T(h),l=!1},d(m){m&&S(n),M(s),h&&h.d()}}}function ll(t){let e,n,s,o,i,r,l=[],a=new Map,f,g,p,c,b,d,h=t[13]&&bt(t);function m(w){t[39](w)}let D={tagsSelected:t[13],keyCombination:t[1]};t[5]!==void 0&&(D.badgeHeight=t[5]),s=new ps({props:D}),te.push(()=>ue(s,"badgeHeight",m)),s.$on("tagselectall",t[34]),s.$on("tagcopy",t[35]),s.$on("tagdelete",t[36]),s.$on("tagappend",t[2]);let A=Ve(t[3]);const E=w=>w[75].id;for(let w=0;w<A.length;w+=1){let $=pt(t,A,w),B=E($);a.set(B,l[w]=wt(B,$))}return g=new Fs({}),g.$on("click",t[2]),{c(){h&&h.c(),e=K(),n=U("div"),o=U("div"),P(s.$$.fragment),r=K();for(let w=0;w<l.length;w+=1)l[w].c();f=K(),P(g.$$.fragment),this.h()},l(w){h&&h.l(w),e=O(w),n=G(w,"DIV",{class:!0});var $=Y(n);o=G($,"DIV",{style:!0});var B=Y(o);j(s.$$.fragment,B),r=O($);for(let z=0;z<l.length;z+=1)l[z].l($);f=O($),j(g.$$.fragment,$),$.forEach(S),this.h()},h(){Le(o,"display","contents"),Le(o,"--icon-align","baseline"),I(n,"class","tag-editor svelte-1tsu84n"),Ct(()=>t[62].call(n))},m(w,$){h&&h.m(w,$),N(w,e,$),N(w,n,$),ge(n,o),W(s,o,null),ge(n,r);for(let B=0;B<l.length;B+=1)l[B]&&l[B].m(n,null);ge(n,f),W(g,n,null),p=yt(n,t[62].bind(n)),c=!0,b||(d=H(n,"focusout",t[33]),b=!0)},p(w,$){w[13]?h?(h.p(w,$),$[0]&8192&&v(h,1)):(h=bt(w),h.c(),v(h,1),h.m(e.parentNode,e)):h&&(be(),T(h,1,1,()=>{h=null}),ke());const B={};$[0]&8192&&(B.tagsSelected=w[13]),$[0]&2&&(B.keyCombination=w[1]),!i&&$[0]&32&&(i=!0,B.badgeHeight=w[5],fe(()=>i=!1)),s.$set(B),$[0]&2147475400|$[1]&11|$[2]&65536&&(A=Ve(w[3]),be(),l=bn(l,$,E,1,w,A,a,n,kn,wt,f,pt),ke())},i(w){if(!c){v(h),v(s.$$.fragment,w);for(let $=0;$<A.length;$+=1)v(l[$]);v(g.$$.fragment,w),c=!0}},o(w){T(h),T(s.$$.fragment,w);for(let $=0;$<l.length;$+=1)T(l[$]);T(g.$$.fragment,w),c=!1},d(w){w&&(S(e),S(n)),h&&h.d(w),M(s);for(let $=0;$<l.length;$+=1)l[$].d();M(g),p(),b=!1,d()}}}const Mt="Control+A",Bt="Control+C",Ht="Backspace",$t=/^:?([^:].*?[^:]):?$/;function St(t){return t===0}function ol(t,e,n){let s,o,i,r,l,a=J,f=()=>(a(),a=Nt(g,u=>n(38,l=u)),g);t.$$.on_destroy.push(()=>a());let{tags:g}=e;f();let{keyCombination:p="Control+Shift+T"}=e;pn(Xe,{selectAllShortcut:Mt,copyShortcut:Bt,removeShortcut:Ht});let c;function b(u){n(3,c=u.map(k=>Je(Qe(k))))}const d=Dt(!1);Ke(t,d,u=>n(66,r=u));const h=de(),m=Promise.resolve([]);let D=m;function A(){const u=c.map(k=>k.name).map(qe);h("tagsupdate",{tags:u}),n(7,D=m)}let E=null,w=null,$="",B,z,Z=!1;async function ie(u){const{tags:k}=await wn({input:u,matchLimit:500});return k}function C(){const k=c[E].name;if(n(12,Z=k.length===0),Z)n(7,D=m);else{const Q=qe(k),pe=$t.test(Q)?Q.replace($t,"$1"):Q;n(7,D=ie(pe).then(ze=>(n(12,Z=ze.length===0),ze.map(Qe))))}}function X(u){const k=c[E];n(9,$=u??k.name);const Q=B.value.length;B.setSelectionRange(Q,Q)}async function re(u){u.name=$,n(3,c),await ee(),B&&z.update()}function Ne(u){w===null&&(w=u)}function Ae(){he();const u=c[c.length-1];(!u||u.name.length>0)&&me(c.length-1,"");const k=E===null;n(8,E=null),k&&Oe()}function me(u,k){c.splice(u+1,0,Je(k)),n(3,c),Ne(u+1)}function Te(u){const k=c.map(Qn);k.splice(u,1);const Q=k.indexOf($);return Q>=0?(c[Q>=u?Q+1:Q].flash(),!1):!0}async function _e(u,k,Q){const pe=$.slice(0,k),ze=$.slice(Q);n(9,$=pe),await ee(),me(u,ze),n(8,E=null),await ee(),u!==E&&B.setSelectionRange(0,0)}function Ce(u){Te(u)&&(c.splice(u,0,Je($)),n(8,E++,E),n(3,c))}function y(u){const k=c.splice(u,1)[0];return n(3,c),w!==null&&w>u&&w--,k}function _(u){return u===c.length-1}function L(u){if(St(u))return;const k=y(u-1);n(9,$=k.name+$),n(8,E--,E),re(c[E])}function oe(u){if(_(u))return;const k=y(u+1);n(9,$=$+k.name),re(c[E])}function ce(u){St(u)||(w=u-1,n(8,E=null),B.blur())}async function x(u){if(_(u)){$.length!==0&&(me(u,""),n(8,E=null));return}w=u+1,n(8,E=null),B.blur(),await ee(),B.setSelectionRange(0,0)}function De(u,k){c.includes(u)&&(Te(k)||y(k))}function Oe(){n(8,E=w),w=null}function zt(u){if(In(u)){z.selectPrevious(),u.preventDefault();return}else if(Pn(u)){z.selectNext(),u.preventDefault();return}switch(u.code){case"Tab":if(r)u.shiftKey?z.selectPrevious():z.selectNext();else break;u.preventDefault();break;case"Enter":z.chooseSelected(),u.preventDefault();break}}let Ee=null,Me=null;function Ue(u){n(3,c[u].selected=!c[u].selected,c),n(3,c),Ee=u}function nt(u){if(Ee===null){Ue(u);return}Me=u;const k=Math.min(Ee,Me),Q=Math.max(Ee,Me);for(let pe=k;pe<=Q;pe++)n(3,c[pe].selected=!0,c);n(3,c)}function he(){n(3,c=c.map(u=>({...u,selected:!1}))),Ee=null,Me=null}function Rt(u){const k=u.currentTarget;(u.relatedTarget===null||!k.contains(u.relatedTarget))&&he()}function qt(u){const k=document.createElement("textarea");k.value=u,k.setAttribute("readonly",""),k.style.position="absolute",k.style.left="-9999px",document.body.appendChild(k),k.select(),Vn("copy"),document.body.removeChild(k)}function st(){for(const u of c)u.selected=!0;n(3,c)}function Lt(){const u=c.filter(k=>k.selected).map(k=>qe(k.name)).join(`
`);qt(u),he()}function Vt(){c.map((u,k)=>[u.selected,k]).filter(([u])=>u).reverse().forEach(([,u])=>y(u)),he(),A()}let Be,He;function Ft(u){He=u,n(5,He)}function Kt(u,k){t.$$.not_equal(k.flash,u)&&(k.flash=u,n(3,c))}function Ot(u,k){t.$$.not_equal(k.selected,u)&&(k.selected=u,n(3,c))}const Ut=u=>{n(8,E=u),he()},Gt=u=>Ue(u),Jt=u=>nt(u),Qt=u=>{he(),y(u),A()};function Yt(u){$=u,n(9,$)}function Xt(u){B=u,n(10,B)}const Zt=(u,k)=>{h("tagsFocused"),n(9,$=u.name),n(11,z=k())},xt=()=>{$.length===0&&(d==null||d.set(!1))},en=u=>re(u),tn=(u,{detail:k})=>_e(u,k.start,k.end),nn=u=>Ce(u),sn=u=>y(u),ln=async()=>{c.length<=1||(B.blur(),await ee(),st())},on=u=>L(u),an=u=>oe(u),rn=u=>ce(u),un=u=>x(u),fn=(u,k)=>{De(u,k),u&&re(u),A(),Oe()},cn=({detail:u})=>X(u.selected),gn=(u,{detail:k})=>{X(k.chosen),_e(u,k.chosen.length,k.chosen.length)};function dn(){Be=this.offsetHeight,n(4,Be)}return t.$$set=u=>{"tags"in u&&f(n(0,g=u.tags)),"keyCombination"in u&&n(1,p=u.keyCombination)},t.$$.update=()=>{t.$$.dirty[1]&128&&b(l),t.$$.dirty[0]&48&&n(37,s=Math.floor(Be/He)),t.$$.dirty[0]&64|t.$$.dirty[1]&64&&n(6,o=o||s>2),t.$$.dirty[0]&8&&n(13,i=c.some(u=>u.selected))},[g,p,Ae,c,Be,He,o,D,E,$,B,z,Z,i,d,h,A,C,X,re,_e,Ce,y,L,oe,ce,x,De,Oe,zt,Ue,nt,he,Rt,st,Lt,Vt,s,l,Ft,Kt,Ot,Ut,Gt,Jt,Qt,Yt,Xt,Zt,xt,en,tn,nn,sn,ln,on,an,rn,un,fn,cn,gn,dn]}class Tl extends ne{constructor(e){super(),se(this,e,ol,ll,le,{tags:0,keyCombination:1,appendEmptyTag:2},null,[-1,-1,-1])}get appendEmptyTag(){return this.$$.ctx[2]}}export{xe as P,Tl as T,kl as a,vl as b,$l as c,wl as d,Vn as e,bl as f,Sl as q,Jn as r,Gn as s};
