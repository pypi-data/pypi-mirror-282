import{S as ne,i as se,s as le,e as U,c as G,D as I,M as R,h as C,ad as at,O as B,P as Pe,a7 as Ye,n as J,f as $,y as ye,l as Ue,Q as me,a5 as Tt,R as Ct,ab as it,T as q,U as te,X as ee,I as $e,B as M,a as F,b as X,C as W,g as K,F as j,j as ge,J as Se,K as ve,L as Te,v,r as T,H,a1 as Ve,V as de,a2 as Oe,A as hn,t as V,d as O,E as Nt,G as yt,q as we,u as ke,_ as ue,$ as fe,k as je,ac as _n,N as Fe,z as At,a3 as pn,Z as bn}from"./Component.-XTVY6ph.mjs";import{e as Ke,u as wn,o as kn}from"./each.mrBeHWFK.mjs";import"./index.HrFqG6o2.mjs";import{y as $n}from"./backend.pzQSPd-R.mjs";import{r as Sn,l as vn,q as Tn,I as Dt,S as qe,g as We,t as Cn,s as Nn,o as rt,v as yn,w as An,x as Dn,y as En,c as In,i as Pn}from"./Shortcut.F_v_rQsz.mjs";import{d as Mn,w as Et}from"./index.grcEGtIt.mjs";import{r as Wn}from"./runtime-require.2UnWAaTy.mjs";import{g as It,a as jn}from"./cross-browser.a5UeKJFq.mjs";import{bj as ut,bk as Hn,bl as Bn,bm as Ln}from"./ftl.cKofWsqB.mjs";import{W as Pt,P as Mt,D as Qe,B as Rn}from"./Badge.EYzNN-L8.mjs";import{W as qn}from"./WithTooltip.ERYnIwCM.mjs";import{p as zn}from"./theme.0LplNH_j.mjs";const wl=Symbol("fontFamily"),kl=Symbol("fontSize"),$l=Symbol("direction"),Sl=Symbol("collapsed"),xe=Symbol("tagActionsShortcuts");function Vn(t,e,n){document.execCommand(t,e,n)}function vl(t){return document.queryCommandState(t)}function Wt(t,e,n){if(!t.parentNode||t===e)return n;{const s=t.parentNode,o=[Array.prototype.indexOf.call(t.parentNode.childNodes,t),...n];return Wt(s,e,o)}}function ft(t,e){return Wt(t,e,[])}function et(t,e){if(e.length===0)return t;if(t.childNodes[e[0]]){const[n,...s]=e;return et(t.childNodes[n],s)}else return null}var tt=(t=>(t[t.Before=-1]="Before",t[t.Equal=0]="Equal",t[t.After=1]="After",t))(tt||{});function On(t,e){const n=Math.min(t.coordinates.length,e.coordinates.length);for(let s=0;s<=n;s++){if(t.coordinates.length===s)return e.coordinates.length===s?t.offset<e.offset?-1:t.offset>e.offset?1:0:-1;if(e.coordinates.length===s)return 1;if(t.coordinates[s]<e.coordinates[s])return-1;if(t.coordinates[s]>e.coordinates[s])return 1}throw new Error("compareLocations: Should never happen")}function Fn(t){const e=It(t),n=jn(e);if(!n)return null;const s=n.collapsed,i={coordinates:ft(e.anchorNode,t),offset:e.anchorOffset};if(s)return{anchor:i,collapsed:s};const l={coordinates:ft(e.focusNode,t),offset:e.focusOffset},f=On(i,l)===tt.After?"backward":"forward";return{anchor:i,focus:l,collapsed:s,direction:f}}function Kn(t){t.empty()}function Un(t,e,n,s){const o=s.focus,i=o.offset,r=et(t,o.coordinates);s.direction==="forward"?(n.setEnd(r,i),e.addRange(n)):(e.addRange(n),e.extend(r,i))}function Gn(t){return Fn(t)}function Jn(t,e){const n=It(t);Kn(n);const s=new Range,o=et(t,e.anchor.coordinates);s.setStart(o,e.anchor.offset),e.collapsed?(s.collapse(!0),n.addRange(s)):Un(t,n,s,e)}Wn("anki/location",{Position:tt,restoreSelection:Jn,saveSelection:Gn});const ae="∷";function Ze(t){return t.replace(/::/g,ae)}function ze(t){return t.replace(/\u2237/gu,"::")}function ct(t){let e=t.trim();for(;e.startsWith(":")||e.startsWith(ae);)e=e.slice(1).trimStart();for(;e.endsWith(":")||e.endsWith(ae);)e=e.slice(0,-1).trimEnd();return e}function Xe(t){return{id:Math.random().toString(36).substring(2),name:t,selected:!1,flash:()=>{}}}function Qn(t){return t.name}function Xn(t){let e,n,s,o;return{c(){e=U("input"),this.h()},l(i){e=G(i,"INPUT",{id:!0,class:!0,type:!0,tabindex:!0,size:!0}),this.h()},h(){I(e,"id",t[2]),I(e,"class",n="tag-input "+t[3]+" svelte-1nk8ij0"),I(e,"type","text"),I(e,"tabindex","-1"),I(e,"size","1"),R(e,"disabled",t[4])},m(i,r){C(i,e,r),t[14](e),at(e,t[0]),s||(o=[B(e,"input",t[15]),B(e,"focus",t[11]),B(e,"blur",Pe(t[6])),B(e,"keydown",t[7]),B(e,"keydown",t[12]),B(e,"keyup",t[13]),B(e,"input",t[16]),B(e,"copy",Pe(t[8])),B(e,"paste",Pe(t[9])),Ye(t[10].call(null,e))],s=!0)},p(i,r){r[0]&4&&I(e,"id",i[2]),r[0]&8&&n!==(n="tag-input "+i[3]+" svelte-1nk8ij0")&&I(e,"class",n),r[0]&1&&e.value!==i[0]&&at(e,i[0]),r[0]&24&&R(e,"disabled",i[4])},i:J,o:J,d(i){i&&$(e),t[14](null),s=!1,ye(o)}}}const Me=Et(null),Tl=Mn(Me,t=>()=>t==null?void 0:t.blur());function Zn(t,e,n){let s,o=J;Ue(t,Me,h=>n(17,s=h)),t.$$.on_destroy.push(()=>o());let{id:i=void 0}=e,{class:r=""}=e,{name:l}=e,{input:a}=e,{disabled:f}=e;const g=me();function p(){return a.selectionStart===a.selectionEnd}function c(){return a.selectionStart===0&&a.selectionEnd===0}function b(){return a.selectionStart===a.value.length&&a.selectionEnd===a.value.length}function d(h){a.setSelectionRange(h,h)}function _(){return l.length===0}async function m(h){const z=a.value.length;g("tagjoinprevious"),await ee(),d(a.value.length-z),h.preventDefault()}async function D(h,z){if(z>l.length)return;l.slice(0,z).endsWith(ae)&&(n(0,l=l.slice(0,z-1)+l.slice(z,l.length)),await ee(),h.preventDefault(),d(z-1),g("taginput"))}function A(h){c()?m(h):D(h,a.selectionStart)}async function E(h){const z=a.value.length;g("tagjoinnext"),await ee(),d(z),h.preventDefault()}function k(h){b()?E(h):D(h,a.selectionStart+2)}function S(){n(0,l=ct(l)),l.length===0&&g("tagdelete"),g("tagaccept")}function P(h){g("tagsplit",{start:a.selectionStart,end:a.selectionEnd}),h.preventDefault()}async function L(h,z=!1){const oe=a.selectionStart,ce=a.selectionEnd,x=l.slice(0,oe),Ee=l.slice(ce,l.length);if(x.endsWith(ae)){h.preventDefault(),h.stopPropagation();return}else if(x.endsWith(":")){h.preventDefault(),n(0,l=`${x.slice(0,-1)}${ae}${l.slice(ce,l.length)}`),await ee(),d(oe),g("taginput");return}else if(Ee.startsWith(":"))h.preventDefault(),n(0,l=`${x}${ae}${l.slice(ce+1,l.length)}`);else{if(z)return;h.preventDefault(),n(0,l=`${x}${ae}${Ee}`)}await ee(),d(oe+1),g("taginput")}function Y(h){switch(h.code){case"Enter":P(h);break;case"Backspace":p()&&A(h);break;case"Delete":p()&&k(h);break}vn(h)?_()?m(h):c()&&(g("tagmoveprevious"),h.preventDefault()):Tn(h)?_()?E(h):b()&&(g("tagmovenext"),h.preventDefault()):h.key===" "?L(h,!1):h.key===":"&&L(h,!0)}function ie(h){const z=document.getSelection();h.clipboardData.setData("text/plain",ze(z.toString()))}function N(h){if(!h.clipboardData)return;const oe=(l+h.clipboardData.getData("text/plain")).split(/\s+/).map(ct).filter(x=>x.length>0).map(Ze);if(oe.length===0)return;const ce=oe.pop();for(const x of oe.reverse())n(0,l=x),g("tagadd");n(0,l=ce)}function Z(h){l.length===0&&(h.preventDefault(),h.stopPropagation(),g("tagselectall"))}const{selectAllShortcut:re}=Tt(xe);Ct(()=>{Sn(Z,re,{target:a}),a.focus()});function Ae(h){return it(Me,s=h,s),{destroy(){s===h&&it(Me,s=null,s)}}}function De(h){q.call(this,t,h)}function he(h){q.call(this,t,h)}function Ce(h){q.call(this,t,h)}function _e(h){te[h?"unshift":"push"](()=>{a=h,n(1,a)})}function Ne(){l=this.value,n(0,l)}const y=()=>g("taginput");return t.$$set=h=>{"id"in h&&n(2,i=h.id),"class"in h&&n(3,r=h.class),"name"in h&&n(0,l=h.name),"input"in h&&n(1,a=h.input),"disabled"in h&&n(4,f=h.disabled)},[l,a,i,r,f,g,S,Y,ie,N,Ae,De,he,Ce,_e,Ne,y]}class Yn extends ne{constructor(e){super(),se(this,e,Zn,Xn,le,{id:2,class:3,name:0,input:1,disabled:4},null,[-1,-1])}}function xn(t){let e,n,s,o;return{c(){e=new Ve(!1),n=F(),s=new Ve(!1),o=de(),this.h()},l(i){e=Oe(i,!1),n=K(i),s=Oe(i,!1),o=de(),this.h()},h(){e.a=n,s.a=o},m(i,r){e.m(Cn,i,r),C(i,n,r),s.m(Nn,i,r),C(i,o,r)},p:J,d(i){i&&(e.d(),$(n),$(o),s.d())}}}function es(t){let e,n,s,o,i,r,l,a,f,g,p;n=new Dt({props:{$$slots:{default:[xn]},$$scope:{ctx:t}}});const c=t[4].default,b=$e(c,t,t[6],null);return a=new qe({props:{keyCombination:t[0]}}),a.$on("action",t[5]),{c(){e=U("div"),M(n.$$.fragment),s=F(),o=U("span"),b&&b.c(),l=F(),M(a.$$.fragment),this.h()},l(d){e=G(d,"DIV",{class:!0,title:!0,role:!0,tabindex:!0});var _=X(e);W(n.$$.fragment,_),s=K(_),o=G(_,"SPAN",{class:!0});var m=X(o);b&&b.l(m),m.forEach($),_.forEach($),l=K(d),W(a.$$.fragment,d),this.h()},h(){I(o,"class","tags-info svelte-1rjs6r4"),I(e,"class","tag-add-button svelte-1rjs6r4"),I(e,"title",i=ut()+" ("+We(t[0])+")"),I(e,"role","button"),I(e,"tabindex",r=t[1]?-1:0)},m(d,_){C(d,e,_),j(n,e,null),ge(e,s),ge(e,o),b&&b.m(o,null),C(d,l,_),j(a,d,_),f=!0,g||(p=[B(e,"click",t[3]),B(e,"focus",t[3])],g=!0)},p(d,[_]){const m={};_&64&&(m.$$scope={dirty:_,ctx:d}),n.$set(m),b&&b.p&&(!f||_&64)&&Se(b,c,d,d[6],f?Te(c,d[6],_,null):ve(d[6]),null),(!f||_&1&&i!==(i=ut()+" ("+We(d[0])+")"))&&I(e,"title",i),(!f||_&2&&r!==(r=d[1]?-1:0))&&I(e,"tabindex",r);const D={};_&1&&(D.keyCombination=d[0]),a.$set(D)},i(d){f||(v(n.$$.fragment,d),v(b,d),v(a.$$.fragment,d),f=!0)},o(d){T(n.$$.fragment,d),T(b,d),T(a.$$.fragment,d),f=!1},d(d){d&&($(e),$(l)),H(n),b&&b.d(d),H(a,d),g=!1,ye(p)}}}function ts(t,e,n){let s;Ue(t,Me,g=>n(1,s=g));let{$$slots:o={},$$scope:i}=e,{keyCombination:r}=e;const l=me();function a(){l("tagappend")}const f=()=>l("tagappend");return t.$$set=g=>{"keyCombination"in g&&n(0,r=g.keyCombination),"$$scope"in g&&n(6,i=g.$$scope)},[r,s,l,a,o,f,i]}class ns extends ne{constructor(e){super(),se(this,e,ts,es,le,{keyCombination:0})}}function ss(t){let e,n;return{c(){e=new Ve(!1),n=de(),this.h()},l(s){e=Oe(s,!1),n=de(),this.h()},h(){e.a=n},m(s,o){e.m(yn,s,o),C(s,n,o)},p:J,d(s){s&&($(n),e.d())}}}function ls(t){let e,n,s,o,i;return n=new Dt({props:{$$slots:{default:[ss]},$$scope:{ctx:t}}}),{c(){e=U("div"),M(n.$$.fragment),this.h()},l(r){e=G(r,"DIV",{class:!0,role:!0,tabindex:!0});var l=X(e);W(n.$$.fragment,l),l.forEach($),this.h()},h(){I(e,"class","tags-selected-button svelte-1d1hiwg"),I(e,"role","button"),I(e,"tabindex","0")},m(r,l){C(r,e,l),j(n,e,null),s=!0,o||(i=[Ye(t[10].call(null,e)),B(e,"click",t[8]),B(e,"keydown",function(){hn(rt(t[9]))&&rt(t[9]).apply(this,arguments)})],o=!0)},p(r,l){t=r;const a={};l&2048&&(a.$$scope={dirty:l,ctx:t}),n.$set(a)},i(r){s||(v(n.$$.fragment,r),s=!0)},o(r){T(n.$$.fragment,r),s=!1},d(r){r&&$(e),H(n),o=!1,ye(i)}}}function os(t){let e=Hn()+"",n,s,o=We(t[2])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=O(l,e),s=O(l," ("),i=O(l,o),r=O(l,")")},m(l,a){C(l,n,a),C(l,s,a),C(l,i,a),C(l,r,a)},p:J,d(l){l&&($(n),$(s),$(i),$(r))}}}function as(t){let e=Bn()+"",n,s,o=We(t[3])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=O(l,e),s=O(l," ("),i=O(l,o),r=O(l,")")},m(l,a){C(l,n,a),C(l,s,a),C(l,i,a),C(l,r,a)},p:J,d(l){l&&($(n),$(s),$(i),$(r))}}}function is(t){let e=Ln()+"",n,s,o=We(t[4])+"",i,r;return{c(){n=V(e),s=V(" ("),i=V(o),r=V(")")},l(l){n=O(l,e),s=O(l," ("),i=O(l,o),r=O(l,")")},m(l,a){C(l,n,a),C(l,s,a),C(l,i,a),C(l,r,a)},p:J,d(l){l&&($(n),$(s),$(i),$(r))}}}function rs(t){let e,n,s,o,i,r;return e=new Qe({props:{$$slots:{default:[os]},$$scope:{ctx:t}}}),e.$on("click",t[5]),s=new Qe({props:{$$slots:{default:[as]},$$scope:{ctx:t}}}),s.$on("click",t[6]),i=new Qe({props:{$$slots:{default:[is]},$$scope:{ctx:t}}}),i.$on("click",t[7]),{c(){M(e.$$.fragment),n=F(),M(s.$$.fragment),o=F(),M(i.$$.fragment)},l(l){W(e.$$.fragment,l),n=K(l),W(s.$$.fragment,l),o=K(l),W(i.$$.fragment,l)},m(l,a){j(e,l,a),C(l,n,a),j(s,l,a),C(l,o,a),j(i,l,a),r=!0},p(l,a){const f={};a&2048&&(f.$$scope={dirty:a,ctx:l}),e.$set(f);const g={};a&2048&&(g.$$scope={dirty:a,ctx:l}),s.$set(g);const p={};a&2048&&(p.$$scope={dirty:a,ctx:l}),i.$set(p)},i(l){r||(v(e.$$.fragment,l),v(s.$$.fragment,l),v(i.$$.fragment,l),r=!0)},o(l){T(e.$$.fragment,l),T(s.$$.fragment,l),T(i.$$.fragment,l),r=!1},d(l){l&&($(n),$(o)),H(e,l),H(s,l),H(i,l)}}}function us(t){let e,n;return e=new Mt({props:{slot:"floating",$$slots:{default:[rs]},$$scope:{ctx:t}}}),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,o){const i={};o&2048&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function fs(t){let e,n;return e=new Pt({props:{show:t[0],preferredPlacement:"top",portalTarget:document.body,shift:0,$$slots:{floating:[us],default:[ls,({asReference:s})=>({10:s}),({asReference:s})=>s?1024:0]},$$scope:{ctx:t}}}),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.show=s[0]),o&2049&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function cs(t,e,n){const s=me();let o=!1;const{selectAllShortcut:i,copyShortcut:r,removeShortcut:l}=Tt(xe);return[o,s,i,r,l,()=>s("tagselectall"),()=>s("tagcopy"),()=>s("tagdelete"),()=>n(0,o=!o),()=>n(0,o=!o)]}class gs extends ne{constructor(e){super(),se(this,e,cs,fs,le,{})}}function ds(t){let e,n;return e=new ns({props:{keyCombination:t[2]}}),e.$on("tagappend",t[7]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,o){const i={};o&4&&(i.keyCombination=s[2]),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function ms(t){let e,n;return e=new gs({}),e.$on("tagselectall",t[4]),e.$on("tagcopy",t[5]),e.$on("tagdelete",t[6]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p:J,i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function hs(t){let e,n,s,o,i,r,l;const a=[ms,ds],f=[];function g(p,c){return p[1]?0:1}return n=g(t),s=f[n]=a[n](t),{c(){e=U("div"),s.c(),this.h()},l(p){e=G(p,"DIV",{class:!0});var c=X(e);s.l(c),c.forEach($),this.h()},h(){I(e,"class","tag-options-button gap svelte-16efk4p"),Nt(()=>t[8].call(e))},m(p,c){C(p,e,c),f[n].m(e,null),o=yt(e,t[8].bind(e)),i=!0,r||(l=B(e,"mousedown",Pe(t[3])),r=!0)},p(p,[c]){let b=n;n=g(p),n===b?f[n].p(p,c):(we(),T(f[b],1,1,()=>{f[b]=null}),ke(),s=f[n],s?s.p(p,c):(s=f[n]=a[n](p),s.c()),v(s,1),s.m(e,null))},i(p){i||(v(s),i=!0)},o(p){T(s),i=!1},d(p){p&&$(e),f[n].d(),o(),r=!1,l()}}}function _s(t,e,n){let{badgeHeight:s}=e,{tagsSelected:o}=e,{keyCombination:i}=e;function r(c){q.call(this,t,c)}function l(c){q.call(this,t,c)}function a(c){q.call(this,t,c)}function f(c){q.call(this,t,c)}function g(c){q.call(this,t,c)}function p(){s=this.offsetHeight,n(0,s)}return t.$$set=c=>{"badgeHeight"in c&&n(0,s=c.badgeHeight),"tagsSelected"in c&&n(1,o=c.tagsSelected),"keyCombination"in c&&n(2,i=c.keyCombination)},[s,o,i,r,l,a,f,g,p]}class ps extends ne{constructor(e){super(),se(this,e,_s,hs,le,{badgeHeight:0,tagsSelected:1,keyCombination:2})}}const bs="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20fill='currentColor'%20class='bi%20bi-x'%20viewBox='0%200%2016%2016'%3e%3cpath%20d='M4.646%204.646a.5.5%200%200%201%20.708%200L8%207.293l2.646-2.647a.5.5%200%200%201%20.708.708L8.707%208l2.647%202.646a.5.5%200%200%201-.708.708L8%208.707l-2.646%202.647a.5.5%200%200%201-.708-.708L7.293%208%204.646%205.354a.5.5%200%200%201%200-.708'/%3e%3c/svg%3e";function ws(t){let e,n;return{c(){e=new Ve(!1),n=de(),this.h()},l(s){e=Oe(s,!1),n=de(),this.h()},h(){e.a=n},m(s,o){e.m(bs,s,o),C(s,n,o)},p:J,d(s){s&&($(n),e.d())}}}function ks(t){let e,n;return e=new Rn({props:{class:"d-flex align-items-center ms-1 "+t[0],iconSize:80,$$slots:{default:[ws]},$$scope:{ctx:t}}}),e.$on("click",t[1]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.class="d-flex align-items-center ms-1 "+s[0]),o&4&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function $s(t,e,n){let{class:s=""}=e;function o(i){q.call(this,t,i)}return t.$$set=i=>{"class"in i&&n(0,s=i.class)},[s,o]}class Ss extends ne{constructor(e){super(),se(this,e,$s,ks,le,{class:0})}}function vs(t){let e,n,s,o,i;const r=t[8].default,l=$e(r,t,t[7],null);return{c(){e=U("button"),l&&l.c(),this.h()},l(a){e=G(a,"BUTTON",{class:!0,tabindex:!0,title:!0,"data-addon-tag":!0});var f=X(e);l&&l.l(f),f.forEach($),this.h()},h(){I(e,"class",n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+t[0]+" svelte-1cw7igw"),I(e,"tabindex","-1"),I(e,"title",t[2]),I(e,"data-addon-tag",t[1]),R(e,"selected",t[3]),R(e,"flashing",t[4])},m(a,f){C(a,e,f),l&&l.m(e,null),t[11](e),s=!0,o||(i=[B(e,"mousemove",t[9]),B(e,"click",t[10])],o=!0)},p(a,[f]){l&&l.p&&(!s||f&128)&&Se(l,r,a,a[7],s?Te(r,a[7],f,null):ve(a[7]),null),(!s||f&1&&n!==(n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+a[0]+" svelte-1cw7igw"))&&I(e,"class",n),(!s||f&4)&&I(e,"title",a[2]),(!s||f&2)&&I(e,"data-addon-tag",a[1]),(!s||f&9)&&R(e,"selected",a[3]),(!s||f&17)&&R(e,"flashing",a[4])},i(a){s||(v(l,a),s=!0)},o(a){T(l,a),s=!1},d(a){a&&$(e),l&&l.d(a),t[11](null),o=!1,ye(i)}}}function Ts(t,e,n){let{$$slots:s={},$$scope:o}=e,{class:i=""}=e,{tagName:r}=e,{tooltip:l=void 0}=e,{selected:a=!1}=e;const f=me();let g=!1;function p(){n(4,g=!0),setTimeout(()=>n(4,g=!1),300)}let c;Ct(()=>f("mount",{button:c}));function b(m){q.call(this,t,m)}function d(m){q.call(this,t,m)}function _(m){te[m?"unshift":"push"](()=>{c=m,n(5,c)})}return t.$$set=m=>{"class"in m&&n(0,i=m.class),"tagName"in m&&n(1,r=m.tagName),"tooltip"in m&&n(2,l=m.tooltip),"selected"in m&&n(3,a=m.selected),"$$scope"in m&&n(7,o=m.$$scope)},[i,r,l,a,g,c,p,o,s,b,d,_]}class nt extends ne{constructor(e){super(),se(this,e,Ts,vs,le,{class:0,tagName:1,tooltip:2,selected:3,flash:6})}get flash(){return this.$$.ctx[6]}}const Cs=t=>({selectMode:t&128}),gt=t=>({selectMode:t[7],hoverClass:st}),Ns=t=>({selectMode:t&128}),dt=t=>({selectMode:t[7],hoverClass:st}),ys=t=>({selectMode:t&128}),mt=t=>({selectMode:t[7],hoverClass:st});function As(t){let e,n,s,o;function i(a){t[19](a)}function r(a){t[20](a)}let l={class:t[3],tagName:t[2],$$slots:{default:[Is]},$$scope:{ctx:t}};return t[1]!==void 0&&(l.flash=t[1]),t[0]!==void 0&&(l.selected=t[0]),e=new nt({props:l}),te.push(()=>ue(e,"flash",i)),te.push(()=>ue(e,"selected",r)),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){M(e.$$.fragment)},l(a){W(e.$$.fragment,a)},m(a,f){j(e,a,f),o=!0},p(a,f){const g={};f&8&&(g.class=a[3]),f&4&&(g.tagName=a[2]),f&2097284&&(g.$$scope={dirty:f,ctx:a}),!n&&f&2&&(n=!0,g.flash=a[1],fe(()=>n=!1)),!s&&f&1&&(s=!0,g.selected=a[0],fe(()=>s=!1)),e.$set(g)},i(a){o||(v(e.$$.fragment,a),o=!0)},o(a){T(e.$$.fragment,a),o=!1},d(a){H(e,a)}}}function Ds(t){let e,n;return e=new qn({props:{tooltip:t[4],trigger:"hover",placement:"top",$$slots:{default:[Ms,({createTooltip:s})=>({23:s}),({createTooltip:s})=>s?8388608:0]},$$scope:{ctx:t}}}),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,o){const i={};o&16&&(i.tooltip=s[4]),o&10485903&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function Es(t){let e,n;return e=new nt({props:{class:t[3],tagName:t[2],$$slots:{default:[Ws]},$$scope:{ctx:t}}}),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,o){const i={};o&8&&(i.class=s[3]),o&4&&(i.tagName=s[2]),o&2097284&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function Is(t){let e,n,s,o;const i=t[15].default,r=$e(i,t,t[21],gt);return{c(){e=U("span"),n=V(t[2]),s=F(),r&&r.c()},l(l){e=G(l,"SPAN",{});var a=X(e);n=O(a,t[2]),a.forEach($),s=K(l),r&&r.l(l)},m(l,a){C(l,e,a),ge(e,n),C(l,s,a),r&&r.m(l,a),o=!0},p(l,a){(!o||a&4)&&je(n,l[2]),r&&r.p&&(!o||a&2097280)&&Se(r,i,l,l[21],o?Te(i,l[21],a,Cs):ve(l[21]),gt)},i(l){o||(v(r,l),o=!0)},o(l){T(r,l),o=!1},d(l){l&&($(e),$(s)),r&&r.d(l)}}}function Ps(t){let e,n=t[11](t[2])+"",s,o,i;const r=t[15].default,l=$e(r,t,t[21],dt);return{c(){e=U("span"),s=V(n),o=F(),l&&l.c()},l(a){e=G(a,"SPAN",{});var f=X(e);s=O(f,n),f.forEach($),o=K(a),l&&l.l(a)},m(a,f){C(a,e,f),ge(e,s),C(a,o,f),l&&l.m(a,f),i=!0},p(a,f){(!i||f&4)&&n!==(n=a[11](a[2])+"")&&je(s,n),l&&l.p&&(!i||f&2097280)&&Se(l,r,a,a[21],i?Te(r,a[21],f,Ns):ve(a[21]),dt)},i(a){i||(v(l,a),i=!0)},o(a){T(l,a),i=!1},d(a){a&&($(e),$(o)),l&&l.d(a)}}}function Ms(t){let e,n,s,o;function i(f){t[16](f)}function r(f){t[17](f)}function l(...f){return t[18](t[23],...f)}let a={class:t[3],tagName:t[2],$$slots:{default:[Ps]},$$scope:{ctx:t}};return t[1]!==void 0&&(a.flash=t[1]),t[0]!==void 0&&(a.selected=t[0]),e=new nt({props:a}),te.push(()=>ue(e,"flash",i)),te.push(()=>ue(e,"selected",r)),e.$on("mousemove",t[9]),e.$on("click",t[10]),e.$on("mount",l),{c(){M(e.$$.fragment)},l(f){W(e.$$.fragment,f)},m(f,g){j(e,f,g),o=!0},p(f,g){t=f;const p={};g&8&&(p.class=t[3]),g&4&&(p.tagName=t[2]),g&2097284&&(p.$$scope={dirty:g,ctx:t}),!n&&g&2&&(n=!0,p.flash=t[1],fe(()=>n=!1)),!s&&g&1&&(s=!0,p.selected=t[0],fe(()=>s=!1)),e.$set(p)},i(f){o||(v(e.$$.fragment,f),o=!0)},o(f){T(e.$$.fragment,f),o=!1},d(f){H(e,f)}}}function Ws(t){let e,n,s;const o=t[15].default,i=$e(o,t,t[21],mt);return{c(){e=V(t[2]),n=F(),i&&i.c()},l(r){e=O(r,t[2]),n=K(r),i&&i.l(r)},m(r,l){C(r,e,l),C(r,n,l),i&&i.m(r,l),s=!0},p(r,l){(!s||l&4)&&je(e,r[2]),i&&i.p&&(!s||l&2097280)&&Se(i,o,r,r[21],s?Te(o,r[21],l,ys):ve(r[21]),mt)},i(r){s||(v(i,r),s=!0)},o(r){T(i,r),s=!1},d(r){r&&($(e),$(n)),i&&i.d(r)}}}function js(t){let e,n,s,o,i,r,l,a;const f=[Es,Ds,As],g=[];function p(c,b){return b&68&&(s=null),c[5]?0:(s==null&&(s=!!(c[6]&&c[12](c[2]))),s?1:2)}return o=p(t,-1),i=g[o]=f[o](t),{c(){e=F(),n=U("div"),i.c(),this.h()},l(c){e=K(c),n=G(c,"DIV",{class:!0});var b=X(n);i.l(b),b.forEach($),this.h()},h(){I(n,"class","svelte-cc9c1q"),R(n,"select-mode",t[7]),R(n,"night-mode",t[8].isDark),R(n,"empty",t[2]==="")},m(c,b){C(c,e,b),C(c,n,b),g[o].m(n,null),r=!0,l||(a=[B(document.body,"keydown",t[9]),B(document.body,"keyup",t[9])],l=!0)},p(c,[b]){let d=o;o=p(c,b),o===d?g[o].p(c,b):(we(),T(g[d],1,1,()=>{g[d]=null}),ke(),i=g[o],i?i.p(c,b):(i=g[o]=f[o](c),i.c()),v(i,1),i.m(n,null)),(!r||b&128)&&R(n,"select-mode",c[7]),(!r||b&256)&&R(n,"night-mode",c[8].isDark),(!r||b&4)&&R(n,"empty",c[2]==="")},i(c){r||(v(i),r=!0)},o(c){T(i),r=!1},d(c){c&&($(e),$(n)),g[o].d(),l=!1,ye(a)}}}const st="tag-icon-hover";function Hs(t,e,n){let s,o;Ue(t,zn,N=>n(8,o=N));let{$$slots:i={},$$scope:r}=e,{name:l}=e,{class:a=""}=e,{tooltip:f}=e,{selected:g}=e,{active:p}=e,{shorten:c}=e,{flash:b}=e;const d=me();let _=!1,m=!1;function D(N){n(13,_=An(N)),n(14,m=Dn(N))}function A(){d(m?"tagrange":_?"tagselect":"tagclick")}function E(N){const Z=N.split(ae);return Z.length===1?N:`…${ae}`+Z[Z.length-1]}function k(N){return N.split(ae).length>1}function S(N){b=N,n(1,b)}function P(N){g=N,n(0,g)}const L=(N,Z)=>N(Z.detail.button);function Y(N){b=N,n(1,b)}function ie(N){g=N,n(0,g)}return t.$$set=N=>{"name"in N&&n(2,l=N.name),"class"in N&&n(3,a=N.class),"tooltip"in N&&n(4,f=N.tooltip),"selected"in N&&n(0,g=N.selected),"active"in N&&n(5,p=N.active),"shorten"in N&&n(6,c=N.shorten),"flash"in N&&n(1,b=N.flash),"$$scope"in N&&n(21,r=N.$$scope)},t.$$.update=()=>{t.$$.dirty&24576&&n(7,s=_||m)},[g,b,l,a,f,p,c,s,o,D,A,E,k,_,m,i,S,P,L,Y,ie,r]}class Bs extends ne{constructor(e){super(),se(this,e,Hs,js,le,{name:2,class:3,tooltip:4,selected:0,active:5,shorten:6,flash:1})}}function Ls(t){let e,n;function s(){return t[9](t[13])}return e=new Ss({props:{class:t[14]}}),e.$on("click",s),{c(){M(e.$$.fragment)},l(o){W(e.$$.fragment,o)},m(o,i){j(e,o,i),n=!0},p(o,i){t=o;const r={};i&16384&&(r.class=t[14]),e.$set(r)},i(o){n||(v(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){H(e,o)}}}function Rs(t){let e,n;return e=new Bs({props:{name:t[0],class:t[1],tooltip:t[2],selected:t[3],active:t[4],shorten:t[5],flash:t[6],$$slots:{default:[Ls,({selectMode:s,hoverClass:o})=>({13:s,14:o}),({selectMode:s,hoverClass:o})=>(s?8192:0)|(o?16384:0)]},$$scope:{ctx:t}}}),e.$on("tagrange",t[10]),e.$on("tagselect",t[11]),e.$on("tagclick",t[12]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,[o]){const i={};o&1&&(i.name=s[0]),o&2&&(i.class=s[1]),o&4&&(i.tooltip=s[2]),o&8&&(i.selected=s[3]),o&16&&(i.active=s[4]),o&32&&(i.shorten=s[5]),o&64&&(i.flash=s[6]),o&57344&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function qs(t,e,n){let{name:s}=e,{class:o=""}=e,{tooltip:i}=e,{selected:r}=e,{active:l}=e,{shorten:a}=e,{flash:f}=e;const g=me();function p(){g("tagdelete")}const c=m=>{m||p()};function b(m){q.call(this,t,m)}function d(m){q.call(this,t,m)}const _=()=>g("tagedit");return t.$$set=m=>{"name"in m&&n(0,s=m.name),"class"in m&&n(1,o=m.class),"tooltip"in m&&n(2,i=m.tooltip),"selected"in m&&n(3,r=m.selected),"active"in m&&n(4,l=m.active),"shorten"in m&&n(5,a=m.shorten),"flash"in m&&n(6,f=m.flash)},[s,o,i,r,l,a,f,g,p,c,b,d,_]}class zs extends ne{constructor(e){super(),se(this,e,qs,Rs,le,{name:0,class:1,tooltip:2,selected:3,active:4,shorten:5,flash:6})}}function Vs(t){let e,n="<br/>",s,o;return{c(){e=U("div"),e.innerHTML=n,this.h()},l(i){e=G(i,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),_n(e)!=="svelte-1t8945d"&&(e.innerHTML=n),this.h()},h(){I(e,"class","tag-spacer svelte-1k3couf"),I(e,"role","textbox"),I(e,"tabindex","-1")},m(i,r){C(i,e,r),s||(o=B(e,"click",t[0]),s=!0)},p:J,i:J,o:J,d(i){i&&$(e),s=!1,o()}}}function Os(t){function e(n){q.call(this,t,n)}return[e]}class Fs extends ne{constructor(e){super(),se(this,e,Os,Vs,le,{})}}function Ks(t){let e,n,s,o;const i=t[5].default,r=$e(i,t,t[4],null);return{c(){e=U("div"),r&&r.c(),this.h()},l(l){e=G(l,"DIV",{tabindex:!0,class:!0,"data-addon-suggestion":!0});var a=X(e);r&&r.l(a),a.forEach($),this.h()},h(){I(e,"tabindex","-1"),I(e,"class","autocomplete-item svelte-k8iwcm"),I(e,"data-addon-suggestion",t[2]),R(e,"selected",t[0]),R(e,"active",t[1])},m(l,a){C(l,e,a),r&&r.m(e,null),t[10](e),n=!0,s||(o=[B(e,"mousedown",Pe(t[6])),B(e,"mouseup",t[7]),B(e,"mouseenter",t[8]),B(e,"mouseleave",t[9])],s=!0)},p(l,[a]){r&&r.p&&(!n||a&16)&&Se(r,i,l,l[4],n?Te(i,l[4],a,null):ve(l[4]),null),(!n||a&4)&&I(e,"data-addon-suggestion",l[2]),(!n||a&1)&&R(e,"selected",l[0]),(!n||a&2)&&R(e,"active",l[1])},i(l){n||(v(r,l),n=!0)},o(l){T(r,l),n=!1},d(l){l&&$(e),r&&r.d(l),t[10](null),s=!1,ye(o)}}}function Us(t,e,n){let{$$slots:s={},$$scope:o}=e,{selected:i=!1}=e,{active:r=!1}=e,{suggestion:l}=e,a;function f(d){q.call(this,t,d)}function g(d){q.call(this,t,d)}function p(d){q.call(this,t,d)}function c(d){q.call(this,t,d)}function b(d){te[d?"unshift":"push"](()=>{a=d,n(3,a)})}return t.$$set=d=>{"selected"in d&&n(0,i=d.selected),"active"in d&&n(1,r=d.active),"suggestion"in d&&n(2,l=d.suggestion),"$$scope"in d&&n(4,o=d.$$scope)},t.$$.update=()=>{t.$$.dirty&9&&i&&a&&a.scrollIntoViewIfNeeded({behavior:"smooth",block:"start"})},[i,r,l,a,o,s,f,g,p,c,b]}class jt extends ne{constructor(e){super(),se(this,e,Us,Ks,le,{selected:0,active:1,suggestion:2})}}const Gs=t=>({}),ht=t=>({createAutocomplete:t[6]});function _t(t,e,n){const s=t.slice();return s[30]=e[n],s[32]=n,s}function Js(t){let e,n,s,o;const i=t[11].default,r=$e(i,t,t[20],ht);return{c(){e=U("span"),r&&r.c(),this.h()},l(l){e=G(l,"SPAN",{class:!0});var a=X(e);r&&r.l(a),a.forEach($),this.h()},h(){I(e,"class","autocomplete-reference svelte-1bkz961")},m(l,a){C(l,e,a),r&&r.m(e,null),n=!0,s||(o=Ye(t[33].call(null,e)),s=!0)},p(l,a){r&&r.p&&(!n||a[0]&1048576)&&Se(r,i,l,l[20],n?Te(i,l[20],a,Gs):ve(l[20]),ht)},i(l){n||(v(r,l),n=!0)},o(l){T(r,l),n=!1},d(l){l&&$(e),r&&r.d(l),s=!1,o()}}}function Qs(t){let e,n;function s(){return t[16](t[32])}function o(){return t[17](t[32])}function i(...r){return t[18](t[32],...r)}return e=new jt({props:{suggestion:t[30],$$slots:{default:[Zs]},$$scope:{ctx:t}}}),e.$on("mousedown",s),e.$on("mouseup",o),e.$on("mouseenter",i),{c(){M(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,l){j(e,r,l),n=!0},p(r,l){t=r;const a={};l[0]&2&&(a.suggestion=t[30]),l[0]&1048578&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function Xs(t){let e,n;function s(){return t[12](t[32])}function o(){return t[13](t[32])}function i(...r){return t[14](t[32],...r)}return e=new jt({props:{selected:!0,active:t[3],suggestion:t[30],$$slots:{default:[Ys]},$$scope:{ctx:t}}}),e.$on("mousedown",s),e.$on("mouseup",o),e.$on("mouseenter",i),e.$on("mouseleave",t[15]),{c(){M(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,l){j(e,r,l),n=!0},p(r,l){t=r;const a={};l[0]&8&&(a.active=t[3]),l[0]&2&&(a.suggestion=t[30]),l[0]&1048578&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function Zs(t){let e=t[30]+"",n,s;return{c(){n=V(e),s=F()},l(o){n=O(o,e),s=K(o)},m(o,i){C(o,n,i),C(o,s,i)},p(o,i){i[0]&2&&e!==(e=o[30]+"")&&je(n,e)},d(o){o&&($(n),$(s))}}}function Ys(t){let e=t[30]+"",n,s;return{c(){n=V(e),s=F()},l(o){n=O(o,e),s=K(o)},m(o,i){C(o,n,i),C(o,s,i)},p(o,i){i[0]&2&&e!==(e=o[30]+"")&&je(n,e)},d(o){o&&($(n),$(s))}}}function pt(t){let e,n,s,o;const i=[Xs,Qs],r=[];function l(a,f){return a[32]===a[2]?0:1}return e=l(t),n=r[e]=i[e](t),{c(){n.c(),s=de()},l(a){n.l(a),s=de()},m(a,f){r[e].m(a,f),C(a,s,f),o=!0},p(a,f){let g=e;e=l(a),e===g?r[e].p(a,f):(we(),T(r[g],1,1,()=>{r[g]=null}),ke(),n=r[e],n?n.p(a,f):(n=r[e]=i[e](a),n.c()),v(n,1),n.m(s.parentNode,s))},i(a){o||(v(n),o=!0)},o(a){T(n),o=!1},d(a){a&&$(s),r[e].d(a)}}}function xs(t){let e,n,s=Ke(t[1]),o=[];for(let r=0;r<s.length;r+=1)o[r]=pt(_t(t,s,r));const i=r=>T(o[r],1,1,()=>{o[r]=null});return{c(){e=U("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=G(r,"DIV",{class:!0});var l=X(e);for(let a=0;a<o.length;a+=1)o[a].l(l);l.forEach($),this.h()},h(){I(e,"class","autocomplete-menu svelte-1bkz961")},m(r,l){C(r,e,l);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);n=!0},p(r,l){if(l[0]&942){s=Ke(r[1]);let a;for(a=0;a<s.length;a+=1){const f=_t(r,s,a);o[a]?(o[a].p(f,l),v(o[a],1)):(o[a]=pt(f),o[a].c(),v(o[a],1),o[a].m(e,null))}for(we(),a=s.length;a<o.length;a+=1)i(a);ke()}},i(r){if(!n){for(let l=0;l<s.length;l+=1)v(o[l]);n=!0}},o(r){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)T(o[l]);n=!1},d(r){r&&$(e),pn(o,r)}}}function el(t){let e,n,s;return e=new Mt({props:{slot:"floating",$$slots:{default:[xs]},$$scope:{ctx:t}}}),{c(){n=U("div"),M(e.$$.fragment),this.h()},l(o){n=G(o,"DIV",{style:!0});var i=X(n);W(e.$$.fragment,i),this.h()},h(){Fe(n,"display","contents"),Fe(n,"--popover-padding-inline","0")},m(o,i){C(o,n,i),j(e,n,null),s=!0},p(o,i){const r={};i[0]&1048590&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(o){s||(v(e.$$.fragment,o),s=!0)},o(o){T(e.$$.fragment,o),s=!1},d(o){o&&e&&$(n),H(e,o)}}}function tl(t){let e,n;return e=new Pt({props:{keepOnKeyup:!0,show:t[4],preferredPlacement:"top",portalTarget:document.body,$$slots:{floating:[el],default:[Js,({asReference:s})=>({33:s}),({asReference:s})=>[0,s?4:0]]},$$scope:{ctx:t}}}),e.$on("close",t[19]),{c(){M(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,o){j(e,s,o),n=!0},p(s,o){const i={};o[0]&16&&(i.show=s[4]),o[0]&1048590&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){H(e,s)}}}function nl(t,e,n){let s,o=J,i=()=>(o(),o=At(f,y=>n(4,s=y)),f);t.$$.on_destroy.push(()=>o());let{$$slots:r={},$$scope:l}=e,{suggestionsPromise:a}=e,{show:f}=e;i();let g=[],p=null,c=!1;const b=me();function d(){p===null?n(2,p=0):p>=g.length-1?n(2,p=null):n(2,p++,p)}function _(){p===null?n(2,p=g.length-1):p===0?n(2,p=null):n(2,p--,p)}async function m(){b("select",{selected:g[p??-1]})}async function D(){d(),await m()}async function A(){_(),await m()}async function E(){n(3,c=!0),b("choose",{chosen:g[p??-1]}),await ee(),f.set(!1)}async function k(){await ee(),b("update")}function S(){return p!==null}function P(){return{selectPrevious:A,selectNext:D,chooseSelected:E,update:k,hasSelected:S}}function L(y){n(2,p=y),n(3,c=!0)}function Y(y){L(y)}async function ie(y){n(3,c=!1),b("select",{selected:g[y]})}function N(y,h){y.buttons===1&&L(h)}const Z=y=>Y(y),re=y=>{ie(y),E()},Ae=(y,h)=>N(h,y),De=()=>n(3,c=!1),he=y=>Y(y),Ce=y=>{ie(y),E()},_e=(y,h)=>N(h,y),Ne=()=>f.set(!1);return t.$$set=y=>{"suggestionsPromise"in y&&n(10,a=y.suggestionsPromise),"show"in y&&i(n(0,f=y.show)),"$$scope"in y&&n(20,l=y.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1025&&a.then(y=>{f.set(y.length>0),En()&&navigator.userAgent.match(/Chrome\/77/)&&(y=y.slice(0,10)),n(1,g=y)})},[f,g,p,c,s,E,P,Y,ie,N,a,r,Z,re,Ae,De,he,Ce,_e,Ne,l]}class sl extends ne{constructor(e){super(),se(this,e,nl,tl,le,{suggestionsPromise:10,show:0},null,[-1,-1])}}function bt(t,e,n){const s=t.slice();return s[75]=e[n],s[76]=e,s[77]=n,s}function wt(t){let e,n,s,o,i,r;return e=new qe({props:{keyCombination:Ht}}),e.$on("action",t[34]),s=new qe({props:{keyCombination:Bt}}),s.$on("action",t[35]),i=new qe({props:{keyCombination:Lt}}),i.$on("action",t[36]),{c(){M(e.$$.fragment),n=F(),M(s.$$.fragment),o=F(),M(i.$$.fragment)},l(l){W(e.$$.fragment,l),n=K(l),W(s.$$.fragment,l),o=K(l),W(i.$$.fragment,l)},m(l,a){j(e,l,a),C(l,n,a),j(s,l,a),C(l,o,a),j(i,l,a),r=!0},p:J,i(l){r||(v(e.$$.fragment,l),v(s.$$.fragment,l),v(i.$$.fragment,l),r=!0)},o(l){T(e.$$.fragment,l),T(s.$$.fragment,l),T(i.$$.fragment,l),r=!1},d(l){l&&($(n),$(o)),H(e,l),H(s,l),H(i,l)}}}function kt(t){let e,n;function s(...o){return t[61](t[77],...o)}return e=new sl({props:{suggestionsPromise:t[7],show:t[14],$$slots:{default:[ll,({createAutocomplete:o})=>({78:o}),({createAutocomplete:o})=>[0,0,o?65536:0]]},$$scope:{ctx:t}}}),e.$on("update",t[17]),e.$on("select",t[60]),e.$on("choose",s),{c(){M(e.$$.fragment)},l(o){W(e.$$.fragment,o)},m(o,i){j(e,o,i),n=!0},p(o,i){t=o;const r={};i[0]&128&&(r.suggestionsPromise=t[7]),i[0]&7688|i[2]&196608&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(o){n||(v(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){H(e,o)}}}function ll(t){let e,n,s,o;function i(A){t[46](A)}function r(A){t[47](A)}function l(){return t[48](t[75],t[78])}function a(){return t[50](t[75])}function f(...A){return t[51](t[77],...A)}function g(){return t[52](t[77])}function p(){return t[53](t[77])}function c(){return t[55](t[77])}function b(){return t[56](t[77])}function d(){return t[57](t[77])}function _(){return t[58](t[77])}function m(){return t[59](t[75],t[77])}let D={id:t[75].id,class:"position-absolute start-0 top-0 bottom-0 ps-2 py-0",disabled:t[12]};return t[9]!==void 0&&(D.name=t[9]),t[10]!==void 0&&(D.input=t[10]),e=new Yn({props:D}),te.push(()=>ue(e,"name",i)),te.push(()=>ue(e,"input",r)),e.$on("focus",l),e.$on("keydown",t[29]),e.$on("keyup",t[49]),e.$on("taginput",a),e.$on("tagsplit",f),e.$on("tagadd",g),e.$on("tagdelete",p),e.$on("tagselectall",t[54]),e.$on("tagjoinprevious",c),e.$on("tagjoinnext",b),e.$on("tagmoveprevious",d),e.$on("tagmovenext",_),e.$on("tagaccept",m),{c(){M(e.$$.fragment)},l(A){W(e.$$.fragment,A)},m(A,E){j(e,A,E),o=!0},p(A,E){t=A;const k={};E[0]&8&&(k.id=t[75].id),E[0]&4096&&(k.disabled=t[12]),!n&&E[0]&512&&(n=!0,k.name=t[9],fe(()=>n=!1)),!s&&E[0]&1024&&(s=!0,k.input=t[10],fe(()=>s=!1)),e.$set(k)},i(A){o||(v(e.$$.fragment,A),o=!0)},o(A){T(e.$$.fragment,A),o=!1},d(A){H(e,A)}}}function $t(t,e){let n,s,o,i,r,l;function a(m){e[40](m,e[75])}function f(m){e[41](m,e[75])}function g(){return e[42](e[77])}function p(){return e[43](e[77])}function c(){return e[44](e[77])}function b(){return e[45](e[77])}let d={class:"ms-0",name:e[77]===e[8]?e[9]:e[75].name,tooltip:e[75].name,active:e[77]===e[8],shorten:e[6]};e[75].flash!==void 0&&(d.flash=e[75].flash),e[75].selected!==void 0&&(d.selected=e[75].selected),s=new zs({props:d}),te.push(()=>ue(s,"flash",a)),te.push(()=>ue(s,"selected",f)),s.$on("tagedit",g),s.$on("tagselect",p),s.$on("tagrange",c),s.$on("tagdelete",b);let _=e[77]===e[8]&&kt(e);return{key:t,first:null,c(){n=U("div"),M(s.$$.fragment),r=F(),_&&_.c(),this.h()},l(m){n=G(m,"DIV",{class:!0});var D=X(n);W(s.$$.fragment,D),r=K(D),_&&_.l(D),D.forEach($),this.h()},h(){I(n,"class","tag-relative svelte-1abeqln"),R(n,"hide-tag",e[77]===e[8]),this.first=n},m(m,D){C(m,n,D),j(s,n,null),ge(n,r),_&&_.m(n,null),l=!0},p(m,D){e=m;const A={};D[0]&776&&(A.name=e[77]===e[8]?e[9]:e[75].name),D[0]&8&&(A.tooltip=e[75].name),D[0]&264&&(A.active=e[77]===e[8]),D[0]&64&&(A.shorten=e[6]),!o&&D[0]&8&&(o=!0,A.flash=e[75].flash,fe(()=>o=!1)),!i&&D[0]&8&&(i=!0,A.selected=e[75].selected,fe(()=>i=!1)),s.$set(A),e[77]===e[8]?_?(_.p(e,D),D[0]&264&&v(_,1)):(_=kt(e),_.c(),v(_,1),_.m(n,null)):_&&(we(),T(_,1,1,()=>{_=null}),ke()),(!l||D[0]&264)&&R(n,"hide-tag",e[77]===e[8])},i(m){l||(v(s.$$.fragment,m),v(_),l=!0)},o(m){T(s.$$.fragment,m),T(_),l=!1},d(m){m&&$(n),H(s),_&&_.d()}}}function ol(t){let e,n,s,o,i,r,l=[],a=new Map,f,g,p,c,b,d,_=t[13]&&wt(t);function m(k){t[39](k)}let D={tagsSelected:t[13],keyCombination:t[1]};t[5]!==void 0&&(D.badgeHeight=t[5]),s=new ps({props:D}),te.push(()=>ue(s,"badgeHeight",m)),s.$on("tagselectall",t[34]),s.$on("tagcopy",t[35]),s.$on("tagdelete",t[36]),s.$on("tagappend",t[2]);let A=Ke(t[3]);const E=k=>k[75].id;for(let k=0;k<A.length;k+=1){let S=bt(t,A,k),P=E(S);a.set(P,l[k]=$t(P,S))}return g=new Fs({}),g.$on("click",t[2]),{c(){_&&_.c(),e=F(),n=U("div"),o=U("div"),M(s.$$.fragment),r=F();for(let k=0;k<l.length;k+=1)l[k].c();f=F(),M(g.$$.fragment),this.h()},l(k){_&&_.l(k),e=K(k),n=G(k,"DIV",{class:!0});var S=X(n);o=G(S,"DIV",{style:!0});var P=X(o);W(s.$$.fragment,P),r=K(S);for(let L=0;L<l.length;L+=1)l[L].l(S);f=K(S),W(g.$$.fragment,S),S.forEach($),this.h()},h(){Fe(o,"display","contents"),Fe(o,"--icon-align","baseline"),I(n,"class","tag-editor svelte-1abeqln"),Nt(()=>t[62].call(n))},m(k,S){_&&_.m(k,S),C(k,e,S),C(k,n,S),ge(n,o),j(s,o,null),ge(n,r);for(let P=0;P<l.length;P+=1)l[P]&&l[P].m(n,null);ge(n,f),j(g,n,null),p=yt(n,t[62].bind(n)),c=!0,b||(d=B(n,"focusout",t[33]),b=!0)},p(k,S){k[13]?_?(_.p(k,S),S[0]&8192&&v(_,1)):(_=wt(k),_.c(),v(_,1),_.m(e.parentNode,e)):_&&(we(),T(_,1,1,()=>{_=null}),ke());const P={};S[0]&8192&&(P.tagsSelected=k[13]),S[0]&2&&(P.keyCombination=k[1]),!i&&S[0]&32&&(i=!0,P.badgeHeight=k[5],fe(()=>i=!1)),s.$set(P),S[0]&2147475400|S[1]&11|S[2]&65536&&(A=Ke(k[3]),we(),l=wn(l,S,E,1,k,A,a,n,kn,$t,f,bt),ke())},i(k){if(!c){v(_),v(s.$$.fragment,k);for(let S=0;S<A.length;S+=1)v(l[S]);v(g.$$.fragment,k),c=!0}},o(k){T(_),T(s.$$.fragment,k);for(let S=0;S<l.length;S+=1)T(l[S]);T(g.$$.fragment,k),c=!1},d(k){k&&($(e),$(n)),_&&_.d(k),H(s);for(let S=0;S<l.length;S+=1)l[S].d();H(g),p(),b=!1,d()}}}const Ht="Control+A",Bt="Control+C",Lt="Backspace",St=/^:?([^:].*?[^:]):?$/;function vt(t){return t===0}function al(t,e,n){let s,o,i,r,l,a=J,f=()=>(a(),a=At(g,u=>n(38,l=u)),g);t.$$.on_destroy.push(()=>a());let{tags:g}=e;f();let{keyCombination:p="Control+Shift+T"}=e;bn(xe,{selectAllShortcut:Ht,copyShortcut:Bt,removeShortcut:Lt});let c;function b(u){n(3,c=u.map(w=>Xe(Ze(w))))}const d=Et(!1);Ue(t,d,u=>n(66,r=u));const _=me(),m=Promise.resolve([]);let D=m;function A(){const u=c.map(w=>w.name).map(ze);_("tagsupdate",{tags:u}),n(7,D=m)}let E=null,k=null,S="",P,L,Y=!1;async function ie(u){const{tags:w}=await $n({input:u,matchLimit:500});return w}function N(){const w=c[E].name;if(n(12,Y=w.length===0),Y)n(7,D=m);else{const Q=ze(w),be=St.test(Q)?Q.replace(St,"$1"):Q;n(7,D=ie(be).then(Re=>(n(12,Y=Re.length===0),Re.map(Ze))))}}function Z(u){const w=c[E];n(9,S=u??w.name);const Q=P.value.length;P.setSelectionRange(Q,Q)}async function re(u){u.name=S,n(3,c),await ee(),P&&L.update()}function Ae(u){k===null&&(k=u)}function De(){pe();const u=c[c.length-1];(!u||u.name.length>0)&&he(c.length-1,"");const w=E===null;n(8,E=null),w&&Ge()}function he(u,w){c.splice(u+1,0,Xe(w)),n(3,c),Ae(u+1)}function Ce(u){const w=c.map(Qn);w.splice(u,1);const Q=w.indexOf(S);return Q>=0?(c[Q>=u?Q+1:Q].flash(),!1):!0}async function _e(u,w,Q){const be=S.slice(0,w),Re=S.slice(Q);n(9,S=be),await ee(),he(u,Re),n(8,E=null),await ee(),u!==E&&P.setSelectionRange(0,0)}function Ne(u){Ce(u)&&(c.splice(u,0,Xe(S)),n(8,E++,E),n(3,c))}function y(u){const w=c.splice(u,1)[0];return n(3,c),k!==null&&k>u&&k--,w}function h(u){return u===c.length-1}function z(u){if(vt(u))return;const w=y(u-1);n(9,S=w.name+S),n(8,E--,E),re(c[E])}function oe(u){if(h(u))return;const w=y(u+1);n(9,S=S+w.name),re(c[E])}function ce(u){vt(u)||(k=u-1,n(8,E=null),P.blur())}async function x(u){if(h(u)){S.length!==0&&(he(u,""),n(8,E=null));return}k=u+1,n(8,E=null),P.blur(),await ee(),P.setSelectionRange(0,0)}function Ee(u,w){c.includes(u)&&(Ce(w)||y(w))}function Ge(){n(8,E=k),k=null}function Rt(u){if(In(u)){L.selectPrevious(),u.preventDefault();return}else if(Pn(u)){L.selectNext(),u.preventDefault();return}switch(u.code){case"Tab":if(r)u.shiftKey?L.selectPrevious():L.selectNext();else break;u.preventDefault();break;case"Enter":L.chooseSelected(),u.preventDefault();break}}let Ie=null,He=null;function Je(u){n(3,c[u].selected=!c[u].selected,c),n(3,c),Ie=u}function lt(u){if(Ie===null){Je(u);return}He=u;const w=Math.min(Ie,He),Q=Math.max(Ie,He);for(let be=w;be<=Q;be++)n(3,c[be].selected=!0,c);n(3,c)}function pe(){n(3,c=c.map(u=>({...u,selected:!1}))),Ie=null,He=null}function qt(u){const w=u.currentTarget;(u.relatedTarget===null||!w.contains(u.relatedTarget))&&pe()}function zt(u){const w=document.createElement("textarea");w.value=u,w.setAttribute("readonly",""),w.style.position="absolute",w.style.left="-9999px",document.body.appendChild(w),w.select(),Vn("copy"),document.body.removeChild(w)}function ot(){for(const u of c)u.selected=!0;n(3,c)}function Vt(){const u=c.filter(w=>w.selected).map(w=>ze(w.name)).join(`
`);zt(u),pe()}function Ot(){c.map((u,w)=>[u.selected,w]).filter(([u])=>u).reverse().forEach(([,u])=>y(u)),pe(),A()}let Be,Le;function Ft(u){Le=u,n(5,Le)}function Kt(u,w){t.$$.not_equal(w.flash,u)&&(w.flash=u,n(3,c))}function Ut(u,w){t.$$.not_equal(w.selected,u)&&(w.selected=u,n(3,c))}const Gt=u=>{n(8,E=u),pe()},Jt=u=>Je(u),Qt=u=>lt(u),Xt=u=>{pe(),y(u),A()};function Zt(u){S=u,n(9,S)}function Yt(u){P=u,n(10,P)}const xt=(u,w)=>{_("tagsFocused"),n(9,S=u.name),n(11,L=w())},en=()=>{S.length===0&&(d==null||d.set(!1))},tn=u=>re(u),nn=(u,{detail:w})=>_e(u,w.start,w.end),sn=u=>Ne(u),ln=u=>y(u),on=async()=>{c.length<=1||(P.blur(),await ee(),ot())},an=u=>z(u),rn=u=>oe(u),un=u=>ce(u),fn=u=>x(u),cn=(u,w)=>{Ee(u,w),u&&re(u),A(),Ge()},gn=({detail:u})=>Z(u.selected),dn=(u,{detail:w})=>{Z(w.chosen),_e(u,w.chosen.length,w.chosen.length)};function mn(){Be=this.offsetHeight,n(4,Be)}return t.$$set=u=>{"tags"in u&&f(n(0,g=u.tags)),"keyCombination"in u&&n(1,p=u.keyCombination)},t.$$.update=()=>{t.$$.dirty[1]&128&&b(l),t.$$.dirty[0]&48&&n(37,s=Math.floor(Be/Le)),t.$$.dirty[0]&64|t.$$.dirty[1]&64&&n(6,o=o||s>2),t.$$.dirty[0]&8&&n(13,i=c.some(u=>u.selected))},[g,p,De,c,Be,Le,o,D,E,S,P,L,Y,i,d,_,A,N,Z,re,_e,Ne,y,z,oe,ce,x,Ee,Ge,Rt,Je,lt,pe,qt,ot,Vt,Ot,s,l,Ft,Kt,Ut,Gt,Jt,Qt,Xt,Zt,Yt,xt,en,tn,nn,sn,ln,on,an,rn,un,fn,cn,gn,dn,mn]}class Cl extends ne{constructor(e){super(),se(this,e,al,ol,le,{tags:0,keyCombination:1,appendEmptyTag:2},null,[-1,-1,-1])}get appendEmptyTag(){return this.$$.ctx[2]}}export{tt as P,Cl as T,kl as a,Tl as b,Sl as c,$l as d,Vn as e,wl as f,vl as q,Jn as r,Gn as s};
