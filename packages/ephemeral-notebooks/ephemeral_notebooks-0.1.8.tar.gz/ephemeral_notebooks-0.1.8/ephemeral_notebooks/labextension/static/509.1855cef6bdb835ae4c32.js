"use strict";(self.webpackChunkephemeral_notebooks=self.webpackChunkephemeral_notebooks||[]).push([[509],{509:(o,e,t)=>{t.r(e),t.d(e,{default:()=>i});var n=t(212),a=t(984),c=t(262),r=t(605),l=t(381),s=t(268);let d=null;const i={id:"urlify-nb",autoStart:!0,requires:[s.IFileBrowserFactory,a.IRouter,r.INotebookTracker],activate:(o,e,t,a)=>{t.register({command:"notebook:start-nav",pattern:/(tempNotebook=1)/,rank:20}),function(o,e){const t=new l.ToolbarButton({label:"Save to URL",onClick:()=>{const o=e.currentWidget;o&&function(o){const e=JSON.stringify(o.context.model.toJSON()),t=n.compressToEncodedURIComponent(e),a=new URL(window.location.href);a.pathname.includes("retro/notebooks/index.html")&&(a.pathname=a.pathname.replace("retro/notebooks/index.html","lab/index.html")),a.hash=`notebook=${t}`,a.searchParams.set("tempNotebook","1"),a.searchParams.set("path","temp.ipynb"),console.log("new url",a,a.toString());const c=a.toString();l.Clipboard.copyToSystem(c)}(o)},tooltip:"Save notebook content to URL and copy to clipboard"});e.widgetAdded.connect(((o,e)=>{e.toolbar.insertItem(10,"saveToUrl",t)}))}(0,a),function(){const o=new URLSearchParams(window.location.hash.slice(1));d=o,console.log("Saved URL parameters:",d.toString())}(),function(o,e,t){if(t){function a(o){const e=new URL(window.location.href),t=window.location.href.match(/(.*\/)lab\/index\.html/);let n=(t?t[1]:"")+`notebooks/index.html?path=${o}&${o}&${e.search}&${e.hash}`;window.location.href=n}o.commands.addCommand("notebook:start-nav",{label:"Open Temp Notebook from URL",execute:async e=>{const{request:n}=e,a=new URL(`http://example.com${n}`).searchParams.get("tempNotebook"),c=async()=>{t.routed.disconnect(c),a&&"1"==a&&await o.commands.execute("notebook:open-temp",{})};t.routed.connect(c)}}),o.commands.addCommand("notebook:open-temp",{label:"Open Temporary Notebook",execute:async t=>{var r,l;console.log("executing create new");const s=null!==(r=null==e?void 0:e.tracker.currentWidget)&&void 0!==r?r:e.defaultBrowser,i=t.cwd||(null!==(l=null==s?void 0:s.model.path)&&void 0!==l?l:""),m=t.kernelId||"",p=t.kernelName||"",u=await(async(e,t,r)=>{const l=await o.commands.execute("docmanager:new-untitled",{path:e,type:"notebook"});if(console.log("created model",l),void 0!==l){const e=await o.commands.execute("docmanager:open",{path:l.path,factory:"Notebook",kernel:{id:t,name:r}});e.isUntitled=!0;const s=`temp-notebook-${c.UUID.uuid4()}`;await e.context.rename(s+".ipynb"),console.log("widget",e,e.context.path);const i=function(){if(d){const o=d.get("notebook");if(o){const e=n.decompressFromEncodedURIComponent(o),t=JSON.parse(e);return console.log("decompressedContent",t),t}}return null}();if(console.log("content",i),i){const o=e.context.model;console.log("model",o),o.fromJSON(i),await e.context.save(),console.log("Notebook content saved.")}return a(e.context.path),e}})(i,m,p);console.log("created model",u,i,"kernel",m,"kernelName",p)}})}}(o,e,t)}}}}]);