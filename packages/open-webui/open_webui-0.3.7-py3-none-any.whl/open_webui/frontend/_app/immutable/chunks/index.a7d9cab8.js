import"./sha256.65a6c54a.js";import{a as x}from"./index.30f324e9.js";let m;const D=new Uint8Array(16);function F(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(D)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function C(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const E=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),w={randomUUID:E};function T(e,t,n){if(w.randomUUID&&!t&&!e)return w.randomUUID();e=e||{};const s=e.random||(e.rng||F)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=s[o];return t}return C(s)}const N=e=>{const t=/<video\s+src="([^"]+)"\s+controls><\/video>/gi,n=[];return e=e.replace(t,(s,o)=>{const r=`{{VIDEO_${n.length}}}`;return n.push(`<video src="${o}" controls></video>`),r}),e=e.replace(/<\|[a-z]*$/,"").replace(/<\|[a-z]+\|$/,"").replace(/<$/,"").replaceAll(/<\|[a-z]+\|>/g," ").replaceAll("<","&lt;").replaceAll(">","&gt;").trim(),n.forEach((s,o)=>{e=e.replace(`{{VIDEO_${o}}}`,s)}),e.trim()},k=(e,t,n)=>{const s=/{{char}}/gi,o=/{{user}}/gi,r=/{{VIDEO_FILE_ID_([a-f0-9-]+)}}/gi,c=/{{HTML_FILE_ID_([a-f0-9-]+)}}/gi;return t!=null&&(e=e.replace(s,t)),n!=null&&(e=e.replace(o,n)),e=e.replace(r,(l,i)=>`<video src="${`${x}/api/v1/files/${i}/content`}" controls></video>`),e=e.replace(c,(l,i)=>`<iframe src="${`${x}/api/v1/files/${i}/content`}" width="100%" frameborder="0" onload="this.style.height=(this.contentWindow.document.body.scrollHeight+20)+'px';"></iframe>`),e},L=e=>e.replaceAll("&lt;","<").replaceAll("&gt;",">"),O=e=>{let t="";return new TransformStream({transform(n,s){t+=n;const o=t.split(e);o.slice(0,-1).forEach(r=>s.enqueue(r)),t=o[o.length-1]},flush(n){t&&n.enqueue(t)}})},V=e=>{const t={messages:{},currentId:null};let n=null,s=null;for(const o of e)s=T(),n!==null&&(t.messages[n].childrenIds=[...t.messages[n].childrenIds,s]),t.messages[s]={...o,id:s,parentId:n,childrenIds:[]},n=s;return t.currentId=s,t},U=()=>{const e=document.createElement("canvas"),t=e.getContext("2d");e.height=1,e.width=1;const n=new ImageData(e.width,e.height),s=n.data;for(let r=0;r<n.data.length;r+=1)r%4!==3?s[r]=Math.floor(256*Math.random()):s[r]=255;t.putImageData(n,0,0);const o=t.getImageData(0,0,e.width,e.height).data;for(let r=0;r<o.length;r+=1)if(o[r]!==s[r])return console.log("canvasPixelTest: Wrong canvas pixel RGB value detected:",o[r],"at:",r,"expected:",s[r]),console.log("canvasPixelTest: Canvas blocking or spoofing is likely"),!1;return!0},z=e=>{const t=document.createElement("canvas"),n=t.getContext("2d");if(t.width=100,t.height=100,!U())return console.log("generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image."),"/user.png";n.fillStyle="#F39C12",n.fillRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.font="40px Helvetica",n.textAlign="center",n.textBaseline="middle";const s=e.trim(),o=s.length>0?s[0]+(s.split(" ").length>1?s[s.lastIndexOf(" ")+1]:""):"";return n.fillText(o.toUpperCase(),t.width/2,t.height/2),t.toDataURL()},H=async e=>{let t=!1;if(!navigator.clipboard){const n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const o=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+o),t=!0}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),t}return t=await navigator.clipboard.writeText(e).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(n=>(console.error("Async: Could not copy text: ",n),!1)),t},P=(e,t)=>t==="0.0.0"?!1:t.localeCompare(e,void 0,{numeric:!0,sensitivity:"case",caseFirst:"upper"})<0,B=e=>{const t=/\[([^\]]+)\]/g,n=[];let s;for(;(s=t.exec(e))!==null;)n.push({word:s[1],startIndex:s.index,endIndex:t.lastIndex-1});return n},Y=e=>{const t=e.split(" "),n=t.findIndex(o=>o.startsWith("#"));return n!==-1&&t.splice(n,1),t.join(" ")},W=e=>e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"-"),j=e=>"mapping"in e[0]?"openai":"webui",q=async(e=!1)=>{const t=await new Promise((o,r)=>{navigator.geolocation.getCurrentPosition(o,r)}).catch(o=>{throw console.error("Error getting user location:",o),o});if(!t)return"Location not available";const{latitude:n,longitude:s}=t.coords;return e?{latitude:n,longitude:s}:`${n.toFixed(3)}, ${s.toFixed(3)} (lat, long)`},R=e=>{var l,i,d,g,f,y,v,I;const t=e.mapping,n=[];let s="",o=null;for(let p in t){const u=t[p];s=p;try{if(n.length==0&&(u.message==null||((l=u.message.content.parts)==null?void 0:l[0])==""&&u.message.content.text==null))continue;{const h={id:p,parentId:o,childrenIds:u.children||[],role:((d=(i=u.message)==null?void 0:i.author)==null?void 0:d.role)!=="user"?"assistant":"user",content:((y=(f=(g=u.message)==null?void 0:g.content)==null?void 0:f.parts)==null?void 0:y[0])||((I=(v=u.message)==null?void 0:v.content)==null?void 0:I.text)||"",model:"gpt-3.5-turbo",done:!0,context:null};n.push(h),o=s}}catch(h){console.log("Error with",u,`
Error:`,h)}}let r={};return n.forEach(p=>r[p.id]=p),{history:{currentId:s,messages:r},models:["gpt-3.5-turbo"],messages:n,options:{},timestamp:e.create_time,title:e.title??"New Chat"}},S=e=>{const t=e.messages;if(t.length===0||t[t.length-1].childrenIds.length!==0||t[0].parentId!==null)return!1;for(let o of t)if(typeof o.content!="string")return!1;return!0},G=e=>{const t=[];let n=0;for(let s of e){const o=R(s);S(o)?t.push({id:s.id,user_id:"",title:s.title,chat:o,timestamp:s.timestamp}):n++}return console.log(n,"Conversations could not be imported"),t},J=e=>{let t;try{t=new URL(e)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"},M=e=>{const t=/[\uD800-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g;return e.replace(t,"")},b=e=>e.replace(/(\*)(.*?)\1/g,"").replace(/(```)(.*?)\1/gs,""),_=e=>{const t=/```[\s\S]*?```/g;let n=[],s=0;e=e.replace(t,r=>{let c=`\0${s}\0`;return n[s++]=r,c});let o=e.split(new RegExp("(?<=[.!?])\\s+"));return o=o.map(r=>r.replace(/\u0000(\d+)\u0000/g,(c,l)=>n[l])),o.map(r=>b(M(r.trim()))).filter(r=>r)},K=e=>_(e).reduce((t,n)=>{const s=t.length-1;if(s>=0){const o=t[s];o.split(/\s+/).length<2?t[s]=o+" "+n:t.push(n)}else t.push(n);return t},[]),Q=(e,t)=>new File([e],t,{type:e.type}),X=(e,t,n)=>{const s=new Date,o=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0"),r=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0});return e=e.replace("{{CURRENT_DATETIME}}",`${o} ${r}`),e=e.replace("{{CURRENT_DATE}}",o),e=e.replace("{{CURRENT_TIME}}",r),t&&(e=e.replace("{{USER_NAME}}",t)),n&&(e=e.replace("{{USER_LOCATION}}",n)),e},Z=e=>{const t=Math.floor(e/1e9%60),n=Math.floor(e/6e10%60),s=Math.floor(e/36e11%24),o=[];return t>=0&&o.push(`${t}s`),n>0&&o.push(`${n}m`),s>0&&o.push(`${s}h`),o.reverse().join(" ")},ee=e=>{const t=new Date,n=new Date(e*1e3),o=(t.getTime()-n.getTime())/(1e3*3600*24),r=t.getDate(),c=t.getMonth(),l=t.getFullYear(),i=n.getDate(),d=n.getMonth(),g=n.getFullYear();return l===g&&c===d&&r===i?"Today":l===g&&c===d&&r-i===1?"Yesterday":o<=7?"Previous 7 days":o<=30?"Previous 30 days":l===g?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()},te=(e,t,n)=>{const s=e.map(r=>r.code);return t.find(r=>s.includes(r))||n};export{H as a,te as b,U as c,P as d,q as e,j as f,z as g,G as h,B as i,J as j,Q as k,K as l,V as m,N as n,k as o,X as p,Z as q,Y as r,O as s,W as t,_ as u,T as v,L as w,ee as x,C as y};
//# sourceMappingURL=index.a7d9cab8.js.map
